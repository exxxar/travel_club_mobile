{"version":3,"sources":["webpack:///./resources/js/desktop/pages/Chat.vue?28ce","webpack:///./resources/js/desktop/pages/Chat.vue?b0bb","webpack:///resources/js/desktop/pages/Chat.vue","webpack:///./resources/js/desktop/pages/Chat.vue?19a6","webpack:///./resources/js/desktop/pages/Chat.vue","webpack:///./resources/js/desktop/pages/Chat.vue?7edd","webpack:///./resources/js/desktop/pages/Chat.vue?a0af","webpack:///./resources/js/desktop/pages/Chat.vue?a94f","webpack:///./resources/js/desktop/pages/Chat.vue?a96c","webpack:///./resources/js/desktop/pages/Chat.vue?1a56"],"names":["append","JSON","stringify","message","component","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","scopedSlots","_u","key","fn","new_chat","user","loading","on","createChat","_e","_v","cancel","proxy","available_users","props","_s","option","info","FullName","model","value","callback","$$v","$set","expression","_m","length","role","open","runSearch","search","chats","load","_l","n","chat","id","class","active","$route","params","$event","toChat","creator_id","manager_title","client_title","messages","_f","created_at","message_text","senderInfo","FirstName","MiddleName","ref","onScroll","chatMessages","message_mode","message_loading","handleFile","type","indexOf","_k","keyCode","ctrlKey","shiftKey","altKey","metaKey","preventDefault","sendChatMessage","trim","onStream","onResult","clearMessage","preview","image_record","name","file_record","audio_record","module","exports","push","i","content","options","transform","undefined","locals"],"mappings":"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","file":"0.js","sourcesContent":["export * from \"-!../../../../node_modules/style-loader/index.js!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=1deea1f8&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container-fluid\",staticStyle:{\"padding\":\"0\"}},[_c('b-modal',{attrs:{\"id\":\"new-chat\",\"title\":\"Создать чат\"},scopedSlots:_vm._u([{key:\"modal-footer\",fn:function(){return [_c('div',{staticClass:\"w-100\"},[_c('b-button',{staticClass:\"float-right\",staticStyle:{\"background\":\"linear-gradient(0deg, #ffbf00 0%, #f08b23 100%)\",\"background-color\":\"#f08b23 !important\",\"border-color\":\"#f08b23 !important\"},attrs:{\"disabled\":_vm.new_chat.user==null ||_vm.new_chat.user==''||_vm.loading},on:{\"click\":_vm.createChat}},[(_vm.loading)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('span',{staticClass:\"sr-only\"},[_vm._v(\"Loading...\")]):_vm._e(),_vm._v(\"\\n                    Создать\\n                \")],1),_vm._v(\" \"),_c('b-button',{staticClass:\"float-right mr-2\",staticStyle:{\"background\":\"linear-gradient(0deg, #ffbf00 0%, #f08b23 100%)\",\"background-color\":\"#f08b23 !important\",\"border-color\":\"#f08b23 !important\"},on:{\"click\":_vm.cancel}},[_vm._v(\"\\n                    Отмена\\n                \")])],1)]},proxy:true}])},[_c('div',{staticClass:\"row w-100 mt-2 mx-auto\"},[_c('multiselect',{staticStyle:{\"line-height\":\"1.5\",\"font-size\":\"0.765625rem\",\"margin\":\"auto\"},attrs:{\"placeholder\":\"Начать чат с...\",\"optionHeight\":29,\"showLabels\":false,\"options\":_vm.available_users,\"multiple\":false,\"label\":\"info.FullName\",\"track-by\":\"id\",\"taggable\":true,\"searchable\":true,\"hideSelected\":true},scopedSlots:_vm._u([{key:\"singleLabel\",fn:function(props){return [_c('span',{staticClass:\"option__title\"},[_vm._v(_vm._s(props.option.info.FullName))])]}},{key:\"option\",fn:function(props){return [_c('span',{staticClass:\"option__title\"},[_vm._v(_vm._s(props.option.info.FullName))])]}}]),model:{value:(_vm.new_chat.user),callback:function ($$v) {_vm.$set(_vm.new_chat, \"user\", $$v)},expression:\"new_chat.user\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row w-100 m-auto align-items-start justify-content-center\"},[_c('div',{staticClass:\"col-sm-4 desktop scrollable\",staticStyle:{\"position\":\"relative\"}},[_c('div',{staticClass:\"row w-100 m-auto\"},[_c('div',{staticClass:\"col-12 pt-3 px-0\"},[_c('div',{staticClass:\"row w-100 mx-auto\",staticStyle:{\"position\":\"sticky\",\"z-index\":\"3\",\"top\":\"0px\"}},[_c('div',{staticClass:\"col-12 p-0\"},[_c('div',{staticClass:\"row w-100 m-auto justify-content-center align-items-center py-2\",staticStyle:{\"background\":\"#f08b23\",\"color\":\"white\",\"border-radius\":\"5px\"}},[_vm._m(0),_vm._v(\" \"),_c('div',{staticClass:\"col-6 col-sm-6\"},[(_vm.available_users.length>0 && _vm.user.role != 'client')?_c('span',{staticClass:\"chat-name ml-auto mr-0\",staticStyle:{\"font-size\":\"25px\",\"float\":\"right\"},on:{\"click\":_vm.open}},[_c('b-icon',{attrs:{\"icon\":\"plus-circle-fill\"}})],1):_vm._e()])])]),_vm._v(\" \"),_c('div',{staticClass:\"col-12 p-0\"},[_c('div',{staticClass:\"row w-100 mx-auto mt-2\"},[_c('b-form-input',{staticClass:\"mb-0 travel-input\",attrs:{\"placeholder\":'Поиск чата'},on:{\"input\":_vm.runSearch},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}})],1)])])]),_vm._v(\" \"),(_vm.chats.length<=0&&_vm.load==false)?_c('div',{staticClass:\"col-12 pt-2 px-0\"},[_c('div',{staticClass:\"row w-100 m-auto\"},_vm._l((5),function(n){return _c('div',{key:n,staticClass:\"col-12 skeleton-tr pt-2 px-0\"},[_c('div',{staticClass:\"list-group\"},[_c('div',{staticClass:\"list-group-item list-group-item-action flex-column align-items-start\"},[_c('div',{staticClass:\"d-flex w-100 justify-content-between\"},[_c('div',{staticClass:\"row m-auto w-100\"},[_c('div',{staticClass:\"col-8 skeleton-tr p-2 mr-auto\"},[_c('tb-skeleton',{attrs:{\"height\":15,\"theme\":\"opacity\",\"bg-color\":\"#dcdbdc\",\"shape\":\"radius\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"col-2 skeleton-tr p-2 ml-auto float-right\"},[_c('tb-skeleton',{attrs:{\"height\":15,\"theme\":\"opacity\",\"bg-color\":\"#dcdbdc\",\"shape\":\"radius\"}})],1)])]),_vm._v(\" \"),_c('div',[_c('div',{staticClass:\"row m-auto w-100\"},[_c('div',{staticClass:\"col-4 skeleton-tr p-2\"},[_c('tb-skeleton',{attrs:{\"height\":10,\"theme\":\"opacity\",\"bg-color\":\"#dcdbdc\",\"shape\":\"radius\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"row m-auto w-100\"},[_c('div',{staticClass:\"col-2 skeleton-tr p-2\"},[_c('tb-skeleton',{attrs:{\"height\":5,\"theme\":\"opacity\",\"bg-color\":\"#dcdbdc\",\"shape\":\"radius\"}})],1)])])])])])}),0)]):_vm._e(),_vm._v(\" \"),(_vm.chats.length<=0&&_vm.load==true)?_c('div',{staticClass:\"col-12 pt-2 px-0\"},[_vm._m(1)]):_vm._e(),_vm._v(\" \"),_vm._l((_vm.filteredChats),function(chat){return _c('div',{key:chat.id,staticClass:\"col-12 pt-2 px-0\"},[_c('div',{staticClass:\"list-group\"},[_c('div',{staticClass:\"list-group-item list-group-item-action flex-column align-items-start\",class:{active: chat.id == _vm.$route.params.id},staticStyle:{\"cursor\":\"pointer\"},on:{\"click\":function($event){return _vm.toChat(chat.id)}}},[_c('div',{staticClass:\"d-flex w-100 justify-content-between\"},[(chat.creator_id == _vm.user.id)?_c('h5',{staticClass:\"mb-1\"},[_vm._v(_vm._s(chat.manager_title))]):_c('h5',{staticClass:\"mb-1\"},[_vm._v(_vm._s(chat.client_title))]),_vm._v(\" \"),(chat.messages.length>0)?_c('small',[_vm._v(_vm._s(_vm._f(\"moment\")(chat.messages[chat.messages.length-1].created_at,\"from\", \"now\")))]):_vm._e()]),_vm._v(\" \"),(chat.messages.length>0)?_c('div',[_c('p',{staticClass:\"mb-1 last_message\"},[_vm._v(_vm._s(chat.messages[chat.messages.length-1].message_text))]),_vm._v(\" \"),_c('small',[_vm._v(_vm._s(chat.messages[chat.messages.length-1].senderInfo.FirstName)+\"\\n                                    \"),(chat.messages[chat.messages.length-1].senderInfo.MiddleName !='' || chat.messages[chat.messages.length-1].senderInfo.MiddleName != null)?_c('span',[_vm._v(\"\\n                                        \"+_vm._s(chat.messages[chat.messages.length-1].senderInfo.MiddleName)+\"\\n                                    \")]):_vm._e()])]):_c('div',[_c('p',{staticClass:\"mb-1 last_message\"},[_vm._v(\"В этой беседе ещё нет сообщений\")])])])])])})],2)]),_vm._v(\" \"),_c('div',{staticClass:\"col-12 col-md-8\",staticStyle:{\"position\":\"relative\"}},[_c('div',{ref:\"chatContainer\",staticClass:\"chat-container\",on:{\"scroll\":_vm.onScroll}},[_c('message',{attrs:{\"messages\":_vm.chatMessages}})],1),_vm._v(\" \"),(_vm.message_mode=='text')?_c('div',{staticClass:\"typer\"},[_c('b-button',{staticClass:\"rounded-circle border p-0 mx-1 paperclip-button\",attrs:{\"disabled\":_vm.message_loading}},[_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"id\":\"file\"},on:{\"change\":function($event){return _vm.handleFile()}}}),_vm._v(\" \"),_c('b-icon',{attrs:{\"icon\":\"paperclip\",\"scale\":\"2\",\"aria-hidden\":\"true\"}})],1),_vm._v(\" \"),_c('b-form-textarea',{staticClass:\"mx-1\",attrs:{\"id\":\"textarea\",\"size\":\"sm\",\"placeholder\":\"Напишите сообщение...\",\"rows\":\"1\",\"max-rows\":\"2\",\"no-resize\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }if($event.ctrlKey||$event.shiftKey||$event.altKey||$event.metaKey){ return null; }$event.preventDefault();return _vm.sendChatMessage('text')}},model:{value:(_vm.message_text),callback:function ($$v) {_vm.message_text=$$v},expression:\"message_text\"}}),_vm._v(\" \"),(_vm.message_text.trim()==''&&_vm.message_mode=='text')?_c('vue-record-audio',{staticClass:\"audio-button mx-1\",attrs:{\"mode\":'press'},on:{\"stream\":_vm.onStream,\"result\":_vm.onResult}}):_c('b-button',{staticClass:\"audio-button rounded-circle p-2 mx-1 text-white border-0\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":function($event){return _vm.sendChatMessage('text')}}},[(!_vm.message_loading)?_c('i',{staticClass:\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\",staticStyle:{\"font-size\":\"25px\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('span',{staticClass:\"sr-only\"},[_vm._v(\"Loading...\")]):_vm._e()],1)],1):_vm._e(),_vm._v(\" \"),(_vm.message_mode=='image')?_c('div',{staticClass:\"typer\"},[_c('b-button',{staticClass:\"rounded-circle border p-0 mx-1 paperclip-button\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":_vm.clearMessage}},[_c('b-icon',{attrs:{\"icon\":\"x\",\"scale\":\"2\",\"aria-hidden\":\"true\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"row m-auto p-2 w-100 h-100 align-items-center justify-content-center\"},[_c('div',{staticClass:\"col-4 h-100 text-center\"},[_c('img',{staticClass:\"preview\",attrs:{\"src\":_vm.preview}})]),_vm._v(\" \"),_c('div',{staticClass:\"col-8 p-0 p-sm-1 p-md-2 h-100\"},[_c('div',{staticStyle:{\"text-overflow\":\"ellipsis\",\"overflow\":\"hidden\",\"width\":\"100%\",\"height\":\"100%\"}},[_vm._v(_vm._s(_vm.image_record.name))])])]),_vm._v(\" \"),_c('b-button',{staticClass:\"audio-button rounded-circle p-2 mx-1 text-white border-0\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":function($event){return _vm.sendChatMessage('image')}}},[(!_vm.message_loading)?_c('i',{staticClass:\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\",staticStyle:{\"font-size\":\"25px\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('span',{staticClass:\"sr-only\"},[_vm._v(\"Loading...\")]):_vm._e()],1)],1):_vm._e(),_vm._v(\" \"),(_vm.message_mode=='file')?_c('div',{staticClass:\"typer\"},[_c('b-button',{staticClass:\"rounded-circle border p-0 mx-1 paperclip-button\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":_vm.clearMessage}},[_c('b-icon',{attrs:{\"icon\":\"x\",\"scale\":\"2\",\"aria-hidden\":\"true\"}})],1),_vm._v(\" \"),_c('div',{staticClass:\"row m-auto p-2 w-100 h-100 align-items-center justify-content-center\"},[_c('div',{staticClass:\"col-4 h-100 text-center\"},[_c('img',{staticClass:\"preview\",attrs:{\"src\":_vm.preview}})]),_vm._v(\" \"),_c('div',{staticClass:\"col-8 p-0 p-sm-1 p-md-2 h-100\"},[_c('div',{staticStyle:{\"text-overflow\":\"ellipsis\",\"overflow\":\"hidden\",\"width\":\"100%\",\"height\":\"100%\"}},[_vm._v(_vm._s(_vm.file_record.name))])])]),_vm._v(\" \"),_c('b-button',{staticClass:\"audio-button rounded-circle p-2 mx-1 text-white border-0\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":function($event){return _vm.sendChatMessage('file')}}},[(!_vm.message_loading)?_c('i',{staticClass:\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\",staticStyle:{\"font-size\":\"25px\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('span',{staticClass:\"sr-only\"},[_vm._v(\"Loading...\")]):_vm._e()],1)],1):_vm._e(),_vm._v(\" \"),(_vm.message_mode=='audio')?_c('div',{staticClass:\"typer justify-content-between\"},[_c('b-button',{staticClass:\"rounded-circle border p-0 mx-1 paperclip-button\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":_vm.clearMessage}},[_c('b-icon',{attrs:{\"icon\":\"x\",\"scale\":\"2\",\"aria-hidden\":\"true\"}})],1),_vm._v(\" \"),_c('audio-player',{staticStyle:{\"width\":\"60%\"},attrs:{\"audio\":_vm.audio_record,\"type\":'file'}}),_vm._v(\" \"),_c('b-button',{staticClass:\"audio-button rounded-circle p-2 mx-1 text-white border-0\",attrs:{\"disabled\":_vm.message_loading},on:{\"click\":function($event){return _vm.sendChatMessage('audio')}}},[(!_vm.message_loading)?_c('i',{staticClass:\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\",staticStyle:{\"font-size\":\"25px\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('b-spinner',{attrs:{\"small\":\"\"}}):_vm._e(),_vm._v(\" \"),(_vm.message_loading)?_c('span',{staticClass:\"sr-only\"},[_vm._v(\"Loading...\")]):_vm._e()],1)],1):_vm._e()])])],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"col-6 col-sm-6\"},[_c('p',{staticClass:\"my-auto\"},[_c('span',{staticClass:\"chat-name\"},[_vm._v(\"Чаты\")])])])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"row w-100 mx-auto mb-2\"},[_c('p',[_vm._v(\"Пока у Вас нет никаких чатов\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container-fluid\" style=\"padding: 0;\">\r\n        <b-modal id=\"new-chat\" title=\"Создать чат\">\r\n            <div class=\"row w-100 mt-2 mx-auto\">\r\n                <multiselect\r\n                    v-model=\"new_chat.user\"\r\n                    placeholder=\"Начать чат с...\"\r\n                    :optionHeight=29\r\n                    :showLabels=false\r\n                    :options=\"available_users\"\r\n                    style=\"line-height: 1.5; font-size: 0.765625rem; margin:auto;\"\r\n                    :multiple=\"false\"\r\n                    label=\"info.FullName\"\r\n                    track-by=\"id\"\r\n                    :taggable=\"true\"\r\n                    :searchable=\"true\"\r\n                    :hideSelected=\"true\"\r\n                >\r\n                    <template slot=\"singleLabel\" slot-scope=\"props\">\r\n                        <span class=\"option__title\">{{ props.option.info.FullName }}</span>\r\n                    </template>\r\n                    <template slot=\"option\" slot-scope=\"props\">\r\n                        <span class=\"option__title\">{{ props.option.info.FullName }}</span>\r\n                    </template>\r\n                </multiselect>\r\n            </div>\r\n            <template v-slot:modal-footer>\r\n                <div class=\"w-100\">\r\n                    <b-button\r\n                        style=\"background: linear-gradient(0deg, #ffbf00 0%, #f08b23 100%); background-color: rgba(0, 0, 0, 0); background-color: #f08b23 !important; border-color: #f08b23 !important;\"\r\n                        class=\"float-right\"\r\n                        @click=\"createChat\"\r\n                        :disabled=\"new_chat.user==null ||new_chat.user==''||loading\"\r\n                    >\r\n                        <b-spinner small v-if=\"loading\"></b-spinner>\r\n                        <span class=\"sr-only\" v-if=\"loading\">Loading...</span>\r\n                        Создать\r\n                    </b-button>\r\n                    <b-button\r\n                        style=\"background: linear-gradient(0deg, #ffbf00 0%, #f08b23 100%); background-color: rgba(0, 0, 0, 0); background-color: #f08b23 !important; border-color: #f08b23 !important;\"\r\n                        class=\"float-right mr-2\"\r\n                        @click=\"cancel\"\r\n                    >\r\n                        Отмена\r\n                    </b-button>\r\n                </div>\r\n            </template>\r\n        </b-modal>\r\n        <div class=\"row w-100 m-auto align-items-start justify-content-center\">\r\n            <div class=\"col-sm-4 desktop scrollable\" style=\"position: relative\">\r\n                <div class=\"row w-100 m-auto\">\r\n                    <div class=\"col-12 pt-3 px-0\">\r\n                        <div class=\"row w-100 mx-auto\" style=\"position: sticky; z-index:3; top: 0px\">\r\n                            <div class=\"col-12 p-0\">\r\n                                <div class=\"row w-100 m-auto justify-content-center align-items-center py-2\" style=\"background: #f08b23; color: white; border-radius: 5px\">\r\n                                    <div class=\"col-6 col-sm-6\">\r\n                                        <p class=\"my-auto\">\r\n                                            <span class=\"chat-name\">Чаты</span>\r\n                                        </p>\r\n                                    </div>\r\n                                    <div class=\"col-6 col-sm-6\">\r\n                                <span class=\"chat-name ml-auto mr-0\" style=\"font-size: 25px; float:right\" v-if=\"available_users.length>0 && user.role != 'client'\" @click=\"open\" >\r\n                                        <b-icon icon=\"plus-circle-fill\"></b-icon>\r\n                                </span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"col-12 p-0\">\r\n                                <div class=\"row w-100 mx-auto mt-2\">\r\n                                    <b-form-input\r\n                                        v-model=\"search\"\r\n                                        :placeholder=\"'Поиск чата'\"\r\n                                        class=\"mb-0 travel-input\"\r\n                                        @input=\"runSearch\"\r\n                                    >\r\n                                    </b-form-input>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-12 pt-2 px-0\" v-if=\"chats.length<=0&&load==false\">\r\n                        <div class=\"row w-100 m-auto\">\r\n                            <div class=\"col-12 skeleton-tr pt-2 px-0\" v-for=\"n in 5\" :key=\"n\">\r\n                                <div class=\"list-group\">\r\n                                    <div class=\"list-group-item list-group-item-action flex-column align-items-start\">\r\n                                        <div class=\"d-flex w-100 justify-content-between\">\r\n                                            <div class=\"row m-auto w-100\">\r\n                                                <div class=\"col-8 skeleton-tr p-2 mr-auto\">\r\n                                                    <tb-skeleton :height=\"15\" theme=\"opacity\" bg-color=\"#dcdbdc\" shape=\"radius\" />\r\n                                                </div>\r\n                                                <div class=\"col-2 skeleton-tr p-2 ml-auto float-right\">\r\n                                                    <tb-skeleton :height=\"15\" theme=\"opacity\" bg-color=\"#dcdbdc\" shape=\"radius\" />\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div>\r\n                                            <div class=\"row m-auto w-100\">\r\n                                                <div class=\"col-4 skeleton-tr p-2\">\r\n                                                    <tb-skeleton :height=\"10\" theme=\"opacity\" bg-color=\"#dcdbdc\" shape=\"radius\" />\r\n                                                </div>\r\n                                            </div>\r\n                                            <div class=\"row m-auto w-100\">\r\n                                                <div class=\"col-2 skeleton-tr p-2\">\r\n                                                    <tb-skeleton :height=\"5\" theme=\"opacity\" bg-color=\"#dcdbdc\" shape=\"radius\" />\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-12 pt-2 px-0\" v-if=\"chats.length<=0&&load==true\">\r\n                        <div class=\"row w-100 mx-auto mb-2\">\r\n                            <p>Пока у Вас нет никаких чатов</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"col-12 pt-2 px-0\" v-for=\"chat in filteredChats\" :key=\"chat.id\">\r\n                        <div class=\"list-group\">\r\n                            <div class=\"list-group-item list-group-item-action flex-column align-items-start\" style=\"cursor: pointer\" :class=\"{active: chat.id == $route.params.id}\" @click=\"toChat(chat.id)\">\r\n                                <div class=\"d-flex w-100 justify-content-between\">\r\n                                    <h5 class=\"mb-1\" v-if=\"chat.creator_id == user.id\">{{chat.manager_title}}</h5>\r\n                                    <h5 class=\"mb-1\" v-else>{{chat.client_title}}</h5>\r\n                                    <small v-if=\"chat.messages.length>0\">{{chat.messages[chat.messages.length-1].created_at | moment(\"from\", \"now\") }}</small>\r\n                                </div>\r\n                                <div v-if=\"chat.messages.length>0\">\r\n                                    <p class=\"mb-1 last_message\">{{chat.messages[chat.messages.length-1].message_text}}</p>\r\n                                    <small>{{chat.messages[chat.messages.length-1].senderInfo.FirstName}}\r\n                                        <span v-if=\"chat.messages[chat.messages.length-1].senderInfo.MiddleName !='' || chat.messages[chat.messages.length-1].senderInfo.MiddleName != null\">\r\n                                            {{chat.messages[chat.messages.length-1].senderInfo.MiddleName}}\r\n                                        </span>\r\n                                    </small>\r\n                                </div>\r\n                                <div v-else>\r\n                                    <p class=\"mb-1 last_message\">В этой беседе ещё нет сообщений</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"col-12 col-md-8\" style=\"position: relative;\">\r\n                <div class=\"chat-container\" v-on:scroll=\"onScroll\" ref=\"chatContainer\">\r\n                    <!--                    <infinite-loading direction=\"top\" @infinite=\"infiniteHandler\" spinner=\"waveDots\">-->\r\n                    <!--                        <span slot=\"no-results\">-->\r\n                    <!--                        </span>-->\r\n                    <!--                        <span slot=\"no-more\">-->\r\n                    <!--                        </span>-->\r\n                    <!--                    </infinite-loading>-->\r\n                    <message :messages=\"chatMessages\"></message>\r\n                </div>\r\n                <div class=\"typer\" v-if=\"message_mode=='text'\">\r\n                    <b-button class=\"rounded-circle border p-0 mx-1 paperclip-button\" :disabled=\"message_loading\">\r\n                        <input type=\"file\" id=\"file\" ref=\"file\" v-on:change=\"handleFile()\"/>\r\n                        <b-icon icon=\"paperclip\" scale=\"2\" aria-hidden=\"true\"></b-icon>\r\n                    </b-button>\r\n                    <b-form-textarea\r\n                        id=\"textarea\"\r\n                        class=\"mx-1\"\r\n                        v-model=\"message_text\"\r\n                        size=\"sm\"\r\n                        placeholder=\"Напишите сообщение...\"\r\n                        rows=\"1\"\r\n                        max-rows=\"2\"\r\n                        no-resize\r\n                        @keydown.enter.exact.prevent=\"sendChatMessage('text')\"\r\n                    >\r\n                    </b-form-textarea>\r\n                    <vue-record-audio v-if=\"message_text.trim()==''&&message_mode=='text'\" :mode=\"'press'\" @stream=\"onStream\" @result=\"onResult\" class=\"audio-button mx-1\"/>\r\n                    <b-button v-else class=\"audio-button rounded-circle p-2 mx-1 text-white border-0\" :disabled=\"message_loading\" @click=\"sendChatMessage('text')\">\r\n                        <i class=\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\" style=\"font-size: 25px;\" v-if=\"!message_loading\"></i>\r\n                        <b-spinner small v-if=\"message_loading\"></b-spinner>\r\n                        <span class=\"sr-only\" v-if=\"message_loading\">Loading...</span>\r\n                    </b-button>\r\n                </div>\r\n                <div class=\"typer\" v-if=\"message_mode=='image'\">\r\n                    <b-button class=\"rounded-circle border p-0 mx-1 paperclip-button\" :disabled=\"message_loading\" @click=\"clearMessage\">\r\n                        <b-icon icon=\"x\" scale=\"2\" aria-hidden=\"true\"></b-icon>\r\n                    </b-button>\r\n                    <div class=\"row m-auto p-2 w-100 h-100 align-items-center justify-content-center\">\r\n                        <div class=\"col-4 h-100 text-center\">\r\n                            <img class=\"preview\" :src=\"preview\"/>\r\n                        </div>\r\n                        <div class=\"col-8 p-0 p-sm-1 p-md-2 h-100\">\r\n                            <div style=\"text-overflow: ellipsis;overflow: hidden;width: 100%;height: 100%;\">{{image_record.name}}</div>\r\n                        </div>\r\n                    </div>\r\n                    <b-button class=\"audio-button rounded-circle p-2 mx-1 text-white border-0\" :disabled=\"message_loading\" @click=\"sendChatMessage('image')\">\r\n                        <i class=\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\" style=\"font-size: 25px;\" v-if=\"!message_loading\"></i>\r\n                        <b-spinner small v-if=\"message_loading\"></b-spinner>\r\n                        <span class=\"sr-only\" v-if=\"message_loading\">Loading...</span>\r\n                    </b-button>\r\n                </div>\r\n                <div class=\"typer\" v-if=\"message_mode=='file'\">\r\n                    <b-button class=\"rounded-circle border p-0 mx-1 paperclip-button\" :disabled=\"message_loading\" @click=\"clearMessage\">\r\n                        <b-icon icon=\"x\" scale=\"2\" aria-hidden=\"true\"></b-icon>\r\n                    </b-button>\r\n                    <div class=\"row m-auto p-2 w-100 h-100 align-items-center justify-content-center\">\r\n                        <div class=\"col-4 h-100 text-center\">\r\n                            <img class=\"preview\" :src=\"preview\"/>\r\n                        </div>\r\n                        <div class=\"col-8 p-0 p-sm-1 p-md-2 h-100\">\r\n                            <div style=\"text-overflow: ellipsis;overflow: hidden;width: 100%;height: 100%;\">{{file_record.name}}</div>\r\n                        </div>\r\n                    </div>\r\n                    <b-button class=\"audio-button rounded-circle p-2 mx-1 text-white border-0\" :disabled=\"message_loading\" @click=\"sendChatMessage('file')\">\r\n                        <i class=\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\" style=\"font-size: 25px;\" v-if=\"!message_loading\"></i>\r\n                        <b-spinner small v-if=\"message_loading\"></b-spinner>\r\n                        <span class=\"sr-only\" v-if=\"message_loading\">Loading...</span>\r\n                    </b-button>\r\n                </div>\r\n                <div class=\"typer justify-content-between\" v-if=\"message_mode=='audio'\">\r\n                    <b-button class=\"rounded-circle border p-0 mx-1 paperclip-button\" :disabled=\"message_loading\" @click=\"clearMessage\">\r\n                        <b-icon icon=\"x\" scale=\"2\" aria-hidden=\"true\"></b-icon>\r\n                    </b-button>\r\n                    <audio-player :audio=\"audio_record\" :type=\"'file'\" style=\"width:60%\"></audio-player>\r\n                    <b-button class=\"audio-button rounded-circle p-2 mx-1 text-white border-0\" :disabled=\"message_loading\" @click=\"sendChatMessage('audio')\">\r\n                        <i class=\"bi-blank icon-send b-icon bi m-0 w-auto h-auto\" style=\"font-size: 25px;\" v-if=\"!message_loading\"></i>\r\n                        <b-spinner small v-if=\"message_loading\"></b-spinner>\r\n                        <span class=\"sr-only\" v-if=\"message_loading\">Loading...</span>\r\n                    </b-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data () {\r\n            return {\r\n                message_text: '',\r\n                audio_record: null,\r\n                image_record: null,\r\n                file_record: null,\r\n                message_mode:'text',\r\n                preview:'',\r\n                message_loading:false,\r\n                flag:false,\r\n                seconds:0,\r\n                interval:'',\r\n                files: [],\r\n                currentChat: {},\r\n                chatMessages: [],\r\n                emojiPanel: false,\r\n                currentRef: {},\r\n                loading: false,\r\n                totalChatHeight: 0,\r\n                search:'',\r\n                results:[],\r\n                options: {\r\n                    // minMatchCharLength: 2,\r\n                    shouldSort: true,\r\n                    threshold: 0.2,\r\n                    keys: ['manager_title', 'client_title']\r\n                },\r\n                new_chat:{\r\n                    name:'',\r\n                    user:null\r\n                },\r\n                load:false,\r\n            }\r\n        },\r\n        mounted () {\r\n            this.chatMessages=[]\r\n            // this.$store.dispatch('loadUserChats').then(()=>{\r\n            //     this.loadChat()\r\n            // })\r\n            this.loadChat()\r\n            this.getUser()\r\n            console.log('this.chatMessages', this.chatMessages)\r\n            console.log('this.currentChat', this.currentChat)\r\n        },\r\n        computed: {\r\n            messages () {\r\n                return this.chatMessages\r\n            },\r\n            chats () {\r\n                return this.$store.getters.chats\r\n            },\r\n            user() {\r\n                return this.$store.getters.user\r\n            },\r\n            available_users() {\r\n                return this.$store.getters.available_users\r\n            },\r\n            filteredChats() {\r\n                if(this.search.trim() === '')\r\n                {\r\n                    return this.chats\r\n                }\r\n                else {\r\n                    return this.results\r\n                }\r\n            }\r\n            // onNewMessageAdded () {\r\n            //     const that = this\r\n            //     let onNewMessageAdded = function (snapshot, newMessage = true) {\r\n            //         let message = {};\r\n            //         /*eslint-disable */\r\n            //         var urlPattern = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig\r\n            //         /*eslint-enable */\r\n            //         message.message_text = message.message_text\r\n            //             .replace(/&/g, '&amp;')\r\n            //             .replace(/</g, '&lt;')\r\n            //             .replace(/>/g, '&gt;')\r\n            //             .replace(/\"/g, '&quot;')\r\n            //             .replace(/'/g, '&#039;')\r\n            //         message.message_text = message.message_text.replace(urlPattern, \"<a href='$1'>$1</a>\")\r\n            //         if (!newMessage) {\r\n            //             // that.chatMessages.unshift(that.processMessage(message))\r\n            //             that.chatMessages.unshift(message)\r\n            //             that.scrollTo()\r\n            //         } else {\r\n            //             that.chatMessages.push(message)\r\n            //             that.scrollToEnd()\r\n            //         }\r\n            //     }\r\n            //     return onNewMessageAdded\r\n            // }\r\n        },\r\n        watch: {\r\n            '$route.params.id' (newId, oldId) {\r\n                // this.currentRef.off('child_added', this.onNewMessageAdded)\r\n                console.log('here wattch')\r\n                this.loadChat()\r\n            }\r\n        },\r\n        methods: {\r\n            toChat(id)\r\n            {\r\n                this.$router.push('/'+this.user.role+'/chat/'+id)\r\n            },\r\n            async getUser() {\r\n                if (!this.user) {\r\n                    await this.$store.dispatch('getUser').then( () => {\r\n                    })\r\n                }\r\n            },\r\n            async loadChat () {\r\n                if(this.chats.length<=0){\r\n\r\n                    await this.$store.dispatch('loadUserChats').then(()=>{\r\n                        this.totalChatHeight = this.$refs.chatContainer.scrollHeight\r\n                        this.loading = false\r\n                        this.load=true\r\n                        if (this.$route.params.id !== undefined) {\r\n                            this.chatMessages = []\r\n                            this.currentChat = this.chats.find((chat) => {if(chat.id == this.$route.params.id)\r\n                            {\r\n                                return true;\r\n                            }});\r\n                            // this.chatMessages = this.currentChat.messages;\r\n                            this.currentChat.messages.forEach((item) => {\r\n                                this.onNewMessageAdded(item, false);\r\n                            })\r\n                            // let chatID = this.id\r\n                            // this.currentRef = firebase.database().ref('messages').child(chatID).child('messages').limitToLast(20)\r\n                            // this.currentRef.on('child_added', this.onNewMessageAdded)\r\n                        }\r\n                    })\r\n                }\r\n                else{\r\n                    this.totalChatHeight = this.$refs.chatContainer.scrollHeight\r\n                    this.loading = false\r\n                    if (this.$route.params.id !== undefined) {\r\n                        this.chatMessages = []\r\n                        this.currentChat = this.chats.find((chat) => {if(chat.id == this.$route.params.id)\r\n                        {\r\n                            return true;\r\n                        }});\r\n                        this.currentChat.messages.forEach((item) => {\r\n                            this.onNewMessageAdded(item, false);\r\n                        })\r\n                    }\r\n                }\r\n\r\n            },\r\n            onScroll () {\r\n                let scrollValue = this.$refs.chatContainer.scrollTop\r\n                const that = this\r\n                if (scrollValue < 100 && !this.loading) {\r\n                    this.totalChatHeight = this.$refs.chatContainer.scrollHeight\r\n                    this.loading = true\r\n                    // let chatID = this.id\r\n                    let currentTopMessage = this.chatMessages[0]\r\n                    if (currentTopMessage === undefined) {\r\n                        this.loading = false\r\n                        return\r\n                    }\r\n                    // firebase.database().ref('messages').child(chatID).child('messages').orderByKey().endAt(currentTopMessage.key).limitToLast(20).once('value').then(\r\n                    //     function (snapshot) {\r\n                    //         let tempArray = []\r\n                    //         snapshot.forEach(function (item) {\r\n                    //             tempArray.push(item)\r\n                    //         })\r\n                    //         if (tempArray[0].key === tempArray[1].key) return\r\n                    //         tempArray.reverse()\r\n                    //         tempArray.forEach(function (child) { that.onNewMessageAdded(child, false) })\r\n                    that.loading = false\r\n                    //     }\r\n                    // )\r\n                }\r\n            },\r\n            processMessage (message) {\r\n                /*eslint-disable */\r\n                var imageRegex = /([^\\s\\']+).(?:jpg|jpeg|gif|png)/i\r\n                /*eslint-enable */\r\n                if (imageRegex.test(message.message_text)) {\r\n                    message.image = imageRegex.exec(message.message_text)[0]\r\n                }\r\n                var emojiRegex = /([\\u{1f300}-\\u{1f5ff}\\u{1f900}-\\u{1f9ff}\\u{1f600}-\\u{1f64f}\\u{1f680}-\\u{1f6ff}\\u{2600}-\\u{26ff}\\u{2700}-\\u{27bf}\\u{1f1e6}-\\u{1f1ff}\\u{1f191}-\\u{1f251}\\u{2934}-\\u{1f18e}])/gu\r\n                if (emojiRegex.test(message.message_text)) {\r\n                    message.message_text = message.message_text.replace(emojiRegex, '<span class=\"emoji\">$1</span>')\r\n                }\r\n                return message\r\n            },\r\n            onNewMessageAdded (message, newMessage = true) {\r\n                /*eslint-disable */\r\n                var urlPattern = /(\\b(https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/ig\r\n                /*eslint-enable */\r\n                message.message_text = message.message_text\r\n                    .replace(/&/g, '&amp;')\r\n                    .replace(/</g, '&lt;')\r\n                    .replace(/>/g, '&gt;')\r\n                    .replace(/\"/g, '&quot;')\r\n                    .replace(/'/g, '&#039;')\r\n                message.message_text = message.message_text.replace(urlPattern, \"<a href='$1'>$1</a>\")\r\n                if (!newMessage) {\r\n                    // that.chatMessages.unshift(that.processMessage(message))\r\n                    // this.chatMessages.unshift(message)\r\n                    this.chatMessages.push(message)\r\n                    console.log('!newMessage')\r\n                    this.scrollTo()\r\n                } else {\r\n                    this.chatMessages.push(message)\r\n                    console.log('newMessage')\r\n                    this.scrollToEnd()\r\n                }\r\n\r\n            },\r\n            async sendChatMessage (type) {\r\n                this.message_loading = true;\r\n                // if (this.message_text !== '') {\r\n                if(this.audio_record!=null){\r\n                    this.files.push(this.audio_record)\r\n                }\r\n                if(this.image_record!=null){\r\n                    this.files.push(this.image_record)\r\n                }\r\n                if(this.file_record!=null){\r\n                    this.files.push(this.file_record)\r\n                }\r\n                var message = {\r\n                    message_text: this.message_text,\r\n                    date: new Date().toString(),\r\n                    conversation_id: this.currentChat.id,\r\n                    sender_id: this.user.id,\r\n                    type: type,\r\n                    files: this.files,\r\n                    senderInfo: this.user.info,\r\n                    selfMessage: true\r\n                }\r\n                let formData = new FormData();\r\n                formData.append(\"message\", JSON.stringify(message));\r\n\r\n                for (var i = 0; i < this.files.length; i++) {\r\n                    let file = this.files[i].data;\r\n\r\n                    formData.append('files[' + i + ']', file);\r\n                }\r\n                await this.$store.dispatch('sendMessage', formData).then(resp=>{\r\n                    this.onNewMessageAdded(resp.data.message, true);\r\n                    this.$store.commit('addChatMessage', resp.data.message);\r\n                    this.message_loading = false;\r\n                });\r\n                this.clearMessage();\r\n                // }\r\n            },\r\n            scrollToEnd () {\r\n                this.$nextTick(() => {\r\n                    var container = this.$el.querySelector('.chat-container')\r\n                    container.scrollTop = container.scrollHeight\r\n                })\r\n            },\r\n            scrollTo () {\r\n                this.$nextTick(() => {\r\n                    let currentHeight = this.$refs.chatContainer.scrollHeight\r\n                    let difference = currentHeight - this.totalChatHeight\r\n                    var container = this.$el.querySelector('.chat-container')\r\n                    container.scrollTop = difference\r\n                })\r\n            },\r\n            addEmojiToMessage (emoji) {\r\n                this.message_text += emoji.value\r\n            },\r\n            toggleEmojiPanel () {\r\n                this.emojiPanel = !this.emojiPanel\r\n            },\r\n            onStream(stream) {\r\n                console.log('before countSeconds')\r\n                this.countSeconds();\r\n                console.log('after countSeconds')\r\n                console.log('Got a stream object:', stream);\r\n                console.log('after stream object')\r\n\r\n            },\r\n            onResult(data) {\r\n                var time = Date.now();\r\n                var date = new Date();\r\n                // this.files.push({\r\n                //     type: 'audio',\r\n                //     name: 'record-'+time+'.mp3',\r\n                //     src: window.URL.createObjectURL(data),\r\n                //     data: data,\r\n                //     date: date,\r\n                // })\r\n                this.audio_record = {\r\n                    type: 'audio',\r\n                    name: 'record-'+time+'.mp3',\r\n                    src: window.URL.createObjectURL(data),\r\n                    data: data,\r\n                    date: date,\r\n                    seconds: this.seconds\r\n                }\r\n                this.countSeconds();\r\n                this.message_mode='audio';\r\n\r\n            },\r\n            handleFile() {\r\n                var time = Date.now();\r\n                var date = new Date();\r\n                let uploadedFile = this.$refs.file.files;\r\n                if (/\\.(jpe?g|png|svg)$/i.test(uploadedFile[0].name))\r\n                {\r\n                    let reader = new FileReader();\r\n                    reader.addEventListener(\"load\", function() {\r\n                        this.preview = reader.result;\r\n                    }.bind(this), false);\r\n                    reader.readAsDataURL(uploadedFile[0]);\r\n                    // this.image_record = uploadedFile[0];\r\n                    this.image_record = {\r\n                        type: 'image',\r\n                        name: uploadedFile[0].name,\r\n                        data: uploadedFile[0],\r\n                        date: date,\r\n                    }\r\n                    this.message_mode = 'image';\r\n                }\r\n                else if(/\\.(pdf|txt|docx|doc)$/i.test(uploadedFile[0].name))\r\n                {\r\n                    // let reader = new FileReader();\r\n                    // reader.addEventListener(\"load\", function() {\r\n                    //     this.preview = reader.result;\r\n                    // }.bind(this), false);\r\n                    // reader.readAsDataURL(uploadedFile[0]);\r\n                    // this.file_record = uploadedFile[0];\r\n                    this.file_record = {\r\n                        type: 'file',\r\n                        name: uploadedFile[0].name,\r\n                        data: uploadedFile[0],\r\n                        date: date,\r\n                    }\r\n                    this.message_mode = 'file';\r\n                    this.$nextTick(function() {\r\n                        this.preview = '/images/LOGO-1.png';\r\n                    });\r\n                }\r\n                else\r\n                {\r\n                    // this.$nextTick(function() {\r\n                    //     this.preview = '/images/LOGO-1.png';\r\n                    // });\r\n                    this.sendMessage('Неверный формат файла')\r\n                    this.clearMessage();\r\n                }\r\n            },\r\n            clearMessage() {\r\n                this.message_text='';\r\n                this.image_record=null;\r\n                this.audio_record=null;\r\n                this.file_record=null;\r\n                this.message_mode='text'\r\n            },\r\n            countSeconds() {\r\n                console.log('this.flag 1', this.flag )\r\n                this.flag = !this.flag\r\n                console.log('this.flag ', this.flag )\r\n                if (this.flag == true) {\r\n                    this.seconds=0;\r\n                    this.interval = setInterval(this.incrementSeconds, 1000);\r\n                }\r\n                else {\r\n                    clearInterval(this.interval)\r\n                    this.audio_record.seconds = this.seconds\r\n                }\r\n            },\r\n            incrementSeconds() {\r\n                this.seconds += 1;\r\n            },\r\n            runSearch () {\r\n                if(this.search.trim() === '')\r\n                {\r\n                    this.results = this.chats\r\n                }\r\n                else {\r\n                    // if(this.search.length > 2){\r\n                    //     this.options.minMatchCharLength=this.search.length\r\n                    // }\r\n                    this.$search(this.search, this.chats, this.options).then(result => {\r\n                        this.results = []\r\n                        result.forEach(item=>{\r\n                            this.results.push(item)\r\n                        })\r\n                    })\r\n                }\r\n                console.log(this.results)\r\n            },\r\n            open(){\r\n                this.$bvModal.show(\"new-chat\");\r\n            },\r\n            cancel(){\r\n                this.$bvModal.hide(\"new-chat\");\r\n            },\r\n            async createChat() {\r\n                this.loading = true;\r\n                var payload = {\r\n                    user_id: this.new_chat.user.id,\r\n                    name: this.new_chat.user.info.FullName\r\n                }\r\n                await this.$store.dispatch('createChat', payload).then( resp => {\r\n                    this.$store.commit('addChat', resp.data.chat)\r\n                    this.$store.commit('removeAvailableUser', this.new_chat.user.id)\r\n                    this.loading=false;\r\n                    this.new_chat = {\r\n                        name:'',\r\n                        user:null\r\n                    };\r\n                    this.cancel();\r\n                })\r\n            },\r\n            sendMessage(message) {\r\n                this.$notify({\r\n                    group: 'info',\r\n                    type: 'travel',\r\n                    title: 'Сообщение от TravelClub',\r\n                    text: message\r\n                });\r\n            },\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .form-control:focus {\r\n        color: #495057;\r\n        background-color: #fff;\r\n        border-color: #f08b23;\r\n        outline: 0;\r\n        box-shadow: 0 0 0 0.2rem rgba(240, 139, 35, 0.25);\r\n    }\r\n    .last_message{\r\n        max-height: 50px;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n    }\r\n    .active {\r\n        background: #f08b23 !important;\r\n        border-color: #f08b23 !important;\r\n    }\r\n    .scrollable {\r\n        overflow-y: auto;\r\n        max-height:calc(100vh - 6.9rem);\r\n        /*max-height:70vh;*/\r\n    }\r\n    .typer{\r\n        box-sizing: border-box;\r\n        display: flex;\r\n        align-items: center;\r\n        bottom: 0;\r\n        height: 4.9rem;\r\n        width: 100%;\r\n        background-color: #fff;\r\n        /*box-shadow: 0 -5px 10px -5px rgba(0,0,0,.2);*/\r\n        border: 2px solid #f08b23;\r\n        border-radius: 5px;\r\n    }\r\n    .typer input[type=text]{\r\n        position: absolute;\r\n        left: 2.5rem;\r\n        padding: 1rem;\r\n        width: 80%;\r\n        background-color: transparent;\r\n        border: none;\r\n        outline: none;\r\n        font-size: 1.25rem;\r\n    }\r\n    /*.typer button {*/\r\n    /*    color: #fff;*/\r\n    /*    background-color: #f8a105;*/\r\n    /*    border-color: #f8a105;*/\r\n    /*    outline: none !important;*/\r\n    /*}*/\r\n    /*.typer button:hover{*/\r\n    /*    color: #fff;*/\r\n    /*    background-color: #063065;*/\r\n    /*    border-color: #063065;*/\r\n    /*}*/\r\n    .chat-container{\r\n        box-sizing: border-box;\r\n        height: calc(95vh - 9.5rem);\r\n        overflow-y: auto;\r\n        padding: 10px;\r\n        /*background-color: #f2f2f2;*/\r\n        background-color: #fff;\r\n    }\r\n    .message{\r\n        margin-bottom: 8px;\r\n    }\r\n    .message.own{\r\n        text-align: right;\r\n    }\r\n    .message.own .content{\r\n        background-color: #ffc890;\r\n    }\r\n    .chat-container .username{\r\n        font-size: 18px;\r\n        font-weight: bold;\r\n    }\r\n    .chat-container .content{\r\n        padding: 8px;\r\n        /*background-color: lightgreen;*/\r\n        background-color: lightskyblue;\r\n        border-radius: 10px;\r\n        display:inline-block;\r\n        box-shadow: 0 1px 3px 0 rgba(0,0,0,0.2), 0 1px 1px 0 rgba(0,0,0,0.14), 0 2px 1px -1px rgba(0,0,0,0.12);\r\n        max-width: 50%;\r\n        word-wrap: break-word;\r\n    }\r\n    @media (max-width: 480px) {\r\n        .chat-container .content{\r\n            max-width: 60%;\r\n        }\r\n    }\r\n    @media screen and (max-width: 576px) {\r\n        .chat-container {\r\n            height: calc(95vh - 6.8rem);\r\n        }\r\n    }\r\n    ::-webkit-file-upload-button {\r\n        cursor:pointer;\r\n    }\r\n    input[type=\"file\"]{\r\n        /*opacity: 0;*/\r\n        /*width: 100%;*/\r\n        /*height: 70px;*/\r\n        /*position: absolute;*/\r\n        /*cursor: pointer;*/\r\n        opacity: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        cursor: pointer;\r\n        top: 0;\r\n        left: 0;\r\n    }\r\n    .preview{\r\n        height: 100%;\r\n        max-width: 90%;\r\n    }\r\n    .paperclip-button {\r\n        position: relative;\r\n        max-width: 45px;\r\n        max-height: 45px;\r\n        width: 100%;\r\n        height: 100%;\r\n        background: transparent;\r\n        color: #f08b23;\r\n        border-color: #f08b23 !important;\r\n        overflow: hidden;\r\n    }\r\n    .paperclip-button:hover {\r\n        color: #f08b23;\r\n        border-color: #f08b23 !important;\r\n    }\r\n    .paperclip-button:active {\r\n        background: #f08b23 !important;\r\n        color: #fff !important;\r\n    }\r\n    .paperclip-button:focus {\r\n        background: #f08b23 !important;\r\n        color: #fff !important;\r\n        outline: none !important;\r\n    }\r\n    .audio-button {\r\n        max-width: 45px;\r\n        max-height: 45px;\r\n        height: 100%;\r\n        width: 100%;\r\n        background-color: #f08b23;\r\n    }\r\n    .audio-button:hover {\r\n        background-color: #f08b23 !important;\r\n    }\r\n</style>\r\n<style>\r\n    .loading-wave-dots .wave-item:nth-child(2) {\r\n        margin-left: -20px;\r\n        -webkit-animation-delay: .14s !important;\r\n        animation-delay: .14s !important;\r\n    }\r\n    .loading-wave-dots[data-v-46b20d22] .wave-item:nth-child(3) {\r\n        margin-left: -4px;\r\n        -webkit-animation-delay: .28s !important;\r\n        animation-delay: .28s !important;\r\n    }\r\n    .loading-wave-dots[data-v-46b20d22] .wave-item:nth-child(4) {\r\n        margin-left: 12px;\r\n        -webkit-animation-delay: .42s !important;\r\n        animation-delay: .42s !important;\r\n    }\r\n    .loading-wave-dots[data-v-46b20d22] .wave-item:last-child {\r\n        margin-left: 28px;\r\n        -webkit-animation-delay: .56s !important;\r\n        animation-delay: .56s !important;\r\n    }\r\n    .loading-wave-dots .wave-item {\r\n        -webkit-animation: wave-dots linear 2.8s infinite !important;\r\n        animation: wave-dots linear 2.8s infinite !important;\r\n    }\r\n    @keyframes wave-dots {\r\n        0% {\r\n            -webkit-transform: translateY(0);\r\n            transform: translateY(0);\r\n            background: #5b43f3;\r\n        }\r\n        10% {\r\n            -webkit-transform: translateY(-6px);\r\n            transform: translateY(-6px);\r\n            background: #5b43f3;\r\n        }\r\n        20% {\r\n            -webkit-transform: translateY(0);\r\n            transform: translateY(0);\r\n            background: #f3434b;\r\n        }\r\n        100% {\r\n            -webkit-transform: translateY(0);\r\n            transform: translateY(0);\r\n            background: #5b43f3;\r\n        }\r\n    }\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Chat.vue?vue&type=template&id=1deea1f8&scoped=true&\"\nimport script from \"./Chat.vue?vue&type=script&lang=js&\"\nexport * from \"./Chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Chat.vue?vue&type=style&index=0&id=1deea1f8&scoped=true&lang=css&\"\nimport style1 from \"./Chat.vue?vue&type=style&index=1&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1deea1f8\",\n  null\n  \n)\n\nexport default component.exports","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".loading-wave-dots .wave-item:nth-child(2){margin-left:-20px;-webkit-animation-delay:.14s!important;animation-delay:.14s!important}.loading-wave-dots[data-v-46b20d22] .wave-item:nth-child(3){margin-left:-4px;-webkit-animation-delay:.28s!important;animation-delay:.28s!important}.loading-wave-dots[data-v-46b20d22] .wave-item:nth-child(4){margin-left:12px;-webkit-animation-delay:.42s!important;animation-delay:.42s!important}.loading-wave-dots[data-v-46b20d22] .wave-item:last-child{margin-left:28px;-webkit-animation-delay:.56s!important;animation-delay:.56s!important}.loading-wave-dots .wave-item{-webkit-animation:wave-dots 2.8s linear infinite!important;animation:wave-dots 2.8s linear infinite!important}@-webkit-keyframes wave-dots{0%{transform:translateY(0);background:#5b43f3}10%{transform:translateY(-6px);background:#5b43f3}20%{transform:translateY(0);background:#f3434b}to{transform:translateY(0);background:#5b43f3}}@keyframes wave-dots{0%{transform:translateY(0);background:#5b43f3}10%{transform:translateY(-6px);background:#5b43f3}20%{transform:translateY(0);background:#f3434b}to{transform:translateY(0);background:#5b43f3}}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=1&lang=css&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=1&lang=css&\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=1&lang=css&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".form-control[data-v-1deea1f8]:focus{color:#495057;background-color:#fff;border-color:#f08b23;outline:0;box-shadow:0 0 0 .2rem rgba(240,139,35,.25)}.last_message[data-v-1deea1f8]{max-height:50px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.active[data-v-1deea1f8]{background:#f08b23!important;border-color:#f08b23!important}.scrollable[data-v-1deea1f8]{overflow-y:auto;max-height:calc(100vh - 6.9rem)}.typer[data-v-1deea1f8]{box-sizing:border-box;display:flex;align-items:center;bottom:0;height:4.9rem;width:100%;background-color:#fff;border:2px solid #f08b23;border-radius:5px}.typer input[type=text][data-v-1deea1f8]{position:absolute;left:2.5rem;padding:1rem;width:80%;background-color:transparent;border:none;outline:none;font-size:1.25rem}.chat-container[data-v-1deea1f8]{box-sizing:border-box;height:calc(95vh - 9.5rem);overflow-y:auto;padding:10px;background-color:#fff}.message[data-v-1deea1f8]{margin-bottom:8px}.message.own[data-v-1deea1f8]{text-align:right}.message.own .content[data-v-1deea1f8]{background-color:#ffc890}.chat-container .username[data-v-1deea1f8]{font-size:18px;font-weight:700}.chat-container .content[data-v-1deea1f8]{padding:8px;background-color:#87cefa;border-radius:10px;display:inline-block;box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);max-width:50%;word-wrap:break-word}@media (max-width:480px){.chat-container .content[data-v-1deea1f8]{max-width:60%}}@media screen and (max-width:576px){.chat-container[data-v-1deea1f8]{height:calc(95vh - 6.8rem)}}[data-v-1deea1f8]::-webkit-file-upload-button{cursor:pointer}input[type=file][data-v-1deea1f8]{opacity:0;width:100%;height:100%;position:absolute;cursor:pointer;top:0;left:0}.preview[data-v-1deea1f8]{height:100%;max-width:90%}.paperclip-button[data-v-1deea1f8]{position:relative;max-width:45px;max-height:45px;width:100%;height:100%;background:transparent;overflow:hidden}.paperclip-button[data-v-1deea1f8],.paperclip-button[data-v-1deea1f8]:hover{color:#f08b23;border-color:#f08b23!important}.paperclip-button[data-v-1deea1f8]:active,.paperclip-button[data-v-1deea1f8]:focus{background:#f08b23!important;color:#fff!important}.paperclip-button[data-v-1deea1f8]:focus{outline:none!important}.audio-button[data-v-1deea1f8]{max-width:45px;max-height:45px;height:100%;width:100%;background-color:#f08b23}.audio-button[data-v-1deea1f8]:hover{background-color:#f08b23!important}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=1deea1f8&scoped=true&lang=css&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=1deea1f8&scoped=true&lang=css&\", function() {\n\t\tvar newContent = require(\"!!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=0&id=1deea1f8&scoped=true&lang=css&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","export * from \"-!../../../../node_modules/style-loader/index.js!../../../../node_modules/css-loader/index.js??ref--7-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--7-2!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Chat.vue?vue&type=style&index=1&lang=css&\""],"sourceRoot":""}