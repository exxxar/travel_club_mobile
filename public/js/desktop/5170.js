/*! For license information please see 5170.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5170],{53361:(e,n,t)=>{t.d(n,{A:()=>r});var s=t(45627),o=t.n(s),i=t(76798),a=t.n(i)()(o());a.push([e.id,".nav-link{color:#f08b23}.nav-link:hover{color:#0d274b}","",{version:3,sources:["webpack://./resources/js/desktop/pages/Manager/Tours/Index.vue"],names:[],mappings:"AAgIA,UACA,aACA,CACA,gBACA,aACA",sourcesContent:["<template>\n    <b-container fluid>\n        <div class=\"row w-100 my-3\">\n            <b-button variant=\"primary\" class=\"btn-travel\" @click=\"toCreateTour\">Создать тур</b-button>\n\x3c!--            <create></create>--\x3e\n        </div>\n        <div class=\"row w-100 mt-3\">\n            <user-table\n                :tours=\"client.tours\"\n                :loading=\"loading\"\n                :totalRows=\"toursTotalRows\"\n            />\n        </div>\n    </b-container>\n</template>\n\n<script>\n    import UserTable from '@/js/desktop/pages/Manager/Tours/Table'\n    // import Create from \"./Create\";\n    export default {\n        components: {\n            UserTable,\n            // Create\n        },\n        data() {\n            return {\n                loading: false,\n                toursTotalRows: 0,\n                deletedToursTotalRows: 0,\n                current_client: {},\n                clientTours:[],\n            }\n        },\n        computed: {\n            menu() {\n                return this.$store.getters.menu\n            },\n            isAdmin : function(){ return this.$store.getters.isAdmin},\n            isManager : function(){ return this.$store.getters.isManager},\n            clients() {\n                return this.$store.getters.clients\n            },\n            client() {\n                return this.current_client\n            },\n            managers() {\n                return this.$store.getters.managers\n            },\n            manager() {\n                return this.current_manager\n            },\n            tourModule() {\n                return this.$store.getters.tourModule\n            },\n            countries() {\n                return this.$store.getters.countries;\n            },\n            cities() {\n                return this.$store.getters.cities;\n            },\n            hotels() {\n                return this.$store.getters.hotels;\n            },\n            branches(){\n                return this.$store.getters.branches\n            },\n\n            //loadings\n            isCountriesLoading() {\n                return this.$store.getters.isCountriesLoading;\n            },\n            isCitiesLoading() {\n                return this.$store.getters.isCitiesLoading;\n            },\n            isHotelsLoading() {\n                return this.$store.getters.isHotelsLoading;\n            },\n        },\n        created() {\n            if (this.countries.length===0) {\n                this.$store.dispatch('getCountries', {town_id:0});\n            }\n            if (this.clients.length>0) {\n                this.loading = true;\n                this.current_client = this.clients.find((client) => client.id == this.$route.params.id);\n                this.loading = false;\n            } else {\n                this.getClient();\n            }\n        },\n        mounted() {\n\n        },\n        methods: {\n            toCreateTour() {\n                if(this.isAdmin){\n                    this.$router.push('/admin/client-tours/'+this.$route.params.id+'/create')\n                }\n                if(this.isManager){\n                    this.$router.push('/manager/client-tours/'+this.$route.params.id+'/create')\n                }\n            },\n            async getClient() {\n                this.loading = true;\n                await this.$store.dispatch('setClients').then(resp => {\n                    this.$store.commit('setClients', resp.data.users);\n                    this.$store.commit('setDeletedClients', resp.data.deleted_users);\n                    this.current_client = this.clients.find((client) => client.id == this.$route.params.id);\n                    this.toursTotalRows =  this.current_client.tours.length;\n                    this.loading = false;\n                })\n            },\n\n            sendMessage(message) {\n                this.$notify({\n                    group: 'info',\n                    type: 'travel',\n                    title: 'Туры пользователей',\n                    text: message\n                });\n            },\n        }\n\n\n    }\n<\/script>\n\n<style>\n.nav-link {\n   color: #f08b23;\n}\n.nav-link:hover {\n   color: #0d274b;\n}\n</style>\n"],sourceRoot:""}]);const r=a},77994:(e,n,t)=>{t.d(n,{A:()=>r});var s=t(45627),o=t.n(s),i=t(76798),a=t.n(i)()(o());a.push([e.id,".btn-travel[data-v-45976b08]{background:#e17e4e;background-color:#e17e4e;background-image:none;background-image:linear-gradient(to bottom left,#e17e4e,#ffbf00,#e17e4e);background-position:100% 0;background-position-x:0;background-position-y:0;background-size:auto;background-size:210% 210%;border:none;box-shadow:none;color:#fff;max-width:300px;transition:all .15s ease}","",{version:3,sources:["webpack://./resources/js/desktop/pages/Manager/Tours/Table.vue"],names:[],mappings:"AAw8BA,6BACA,kBAAA,CASA,wBAAA,CALA,qBAAA,CAEA,wEAAA,CAEA,0BAAA,CANA,uBAAA,CACA,uBAAA,CAEA,oBAAA,CAEA,yBAAA,CAOA,WAAA,CAHA,eAAA,CACA,UAAA,CACA,eAAA,CAHA,wBAKA",sourcesContent:['<template>\n    <div class="w-100 m-auto">\n        <b-row>\n            <b-col lg="6" class="my-1">\n                <b-form-group\n                    label="Сортировка"\n                    label-cols-sm="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="order_bySelect1"\n                    class="mb-0"\n                >\n                    <b-input-group size="sm">\n                        <b-form-select v-model="order_by" id="order_bySelect1" :options="sortOptions" class="w-75">\n                            <template v-slot:first>\n                                <option value="">-- none --</option>\n                            </template>\n                        </b-form-select>\n                        <b-form-select v-model="sortDesc" size="sm" :disabled="!order_by" class="w-25">\n                            <option :value="false">Asc</option>\n                            <option :value="true">Desc</option>\n                        </b-form-select>\n                    </b-input-group>\n                </b-form-group>\n            </b-col>\n\n            <b-col lg="6" class="my-1">\n                <b-form-group\n                    label="Поиск"\n                    label-cols-sm="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="filterInput"\n                    class="mb-0"\n                >\n                    <b-input-group size="sm">\n                        <b-form-input\n                            v-model="filter"\n                            type="search"\n                            id="filterInput"\n                            placeholder="Введите для поиска"\n                        />\n                        <b-input-group-append>\n                            <b-button :disabled="!filter" @click="filter = \'\'">Очистить</b-button>\n                        </b-input-group-append>\n                    </b-input-group>\n                </b-form-group>\n            </b-col>\n\n            <b-col sm="5" md="6" class="my-1">\n                <b-form-group\n                    label="На странице"\n                    label-cols-sm="6"\n                    label-cols-md="4"\n                    label-cols-lg="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="perPageSelect1"\n                    class="mb-0"\n                >\n                    <b-form-select\n                        v-model="perPage"\n                        id="perPageSelect1"\n                        size="sm"\n                        :options="pageOptions"\n                    />\n                </b-form-group>\n            </b-col>\n\n            <b-col sm="7" md="6" class="my-1">\n                <b-pagination\n                    v-model="currentPage"\n                    :total-rows="totalRows"\n                    :per-page="perPage"\n                    align="fill"\n                    size="sm"\n                    class="my-0"\n                >\n                </b-pagination>\n            </b-col>\n        </b-row>\n        <b-table\n            show-empty\n            small\n            stacked="md"\n            :items="tours"\n            :fields="fields"\n            :current-page="currentPage"\n            :per-page="perPage"\n            :filter="filter"\n            :filterIncludedFields="filterOn"\n            :sort-by.sync="order_by"\n            :sort-desc.sync="sortDesc"\n            :sort-direction="order_direction"\n            @filtered="onFiltered"\n            :busy="loading"\n            empty-text="Нет записей для отображения"\n            empty-filtered-text="Нет записей, соответствующих вашему запросу"\n        >\n            <template v-slot:cell(created_at)="data">\n                {{data.item.created_at | moment(\'DD.MM.YYYY\')}}\n            </template>\n\x3c!--            <template v-slot:cell(TourInfo.date_range)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <VueHotelDatepicker--\x3e\n\x3c!--                        ref="datepickerId"--\x3e\n\x3c!--                        :startDate="data.item.TourInfo.start"--\x3e\n\x3c!--                        :endDate="data.item.TourInfo.end"--\x3e\n\x3c!--                        :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                        :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                        :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                        :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                        :fromText="\'С\'"--\x3e\n\x3c!--                        :toText="\'По\'"--\x3e\n\x3c!--                        :resetText="\'Очистить\'"--\x3e\n\x3c!--                        :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                        :mobile="\'mobile\'"--\x3e\n\x3c!--                        class="w-100"--\x3e\n\x3c!--                        @update="save($event,data.item.id,\'date_range\')"--\x3e\n\x3c!--                    />--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.country)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        v-model="data.item.TourInfo.country"--\x3e\n\x3c!--                        :options="countries"--\x3e\n\x3c!--                        :option-height="25"--\x3e\n\x3c!--                        placeholder="Выберите страну"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :loading="isCountriesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'country\')"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                        <template slot="option" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.resort)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        :value="data.item.TourInfo.resort"--\x3e\n\x3c!--                        :options="cities"--\x3e\n\x3c!--                        placeholder="Введите название курорта"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                        :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'resort\')"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        :preselectFirst="true"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.price)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.price"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'price\')"--\x3e\n\x3c!--                                  placeholder="Цена"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.paid)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.paid"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'paid\')"--\x3e\n\x3c!--                                  placeholder="Выплачено"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>  <template v-slot:cell(TourInfo.date_range)="data">--\x3e\n\x3c!--            <b-input-group size="sm">--\x3e\n\x3c!--                <VueHotelDatepicker--\x3e\n\x3c!--                    ref="datepickerId"--\x3e\n\x3c!--                    :startDate="data.item.TourInfo.start"--\x3e\n\x3c!--                    :endDate="data.item.TourInfo.end"--\x3e\n\x3c!--                    :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                    :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                    :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                    :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                    :fromText="\'С\'"--\x3e\n\x3c!--                    :toText="\'По\'"--\x3e\n\x3c!--                    :resetText="\'Очистить\'"--\x3e\n\x3c!--                    :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                    :mobile="\'mobile\'"--\x3e\n\x3c!--                    class="w-100"--\x3e\n\x3c!--                    @update="save($event,data.item.id,\'date_range\')"--\x3e\n\x3c!--                />--\x3e\n\x3c!--            </b-input-group>--\x3e\n\x3c!--        </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.country)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        v-model="data.item.TourInfo.country"--\x3e\n\x3c!--                        :options="countries"--\x3e\n\x3c!--                        :option-height="25"--\x3e\n\x3c!--                        placeholder="Выберите страну"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :loading="isCountriesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'country\')"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                        <template slot="option" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.resort)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        :value="data.item.TourInfo.resort"--\x3e\n\x3c!--                        :options="cities"--\x3e\n\x3c!--                        placeholder="Введите название курорта"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                        :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'resort\')"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        :preselectFirst="true"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.price)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.price"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'price\')"--\x3e\n\x3c!--                                  placeholder="Цена"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.paid)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.paid"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'paid\')"--\x3e\n\x3c!--                                  placeholder="Выплачено"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n            <template v-slot:cell(action1)="data">\n                <b-input-group size="sm">\n\x3c!--                    <b-button @click="data.toggleDetails" class="w-100 btn btn-travel mr-1 mb-1 btn-travel">--\x3e\n\x3c!--                        {{ data.detailsShowing ? \'Свернуть\' : \'Редактировать\' }}--\x3e\n\x3c!--                    </b-button> --\x3e\n                    <b-button @click="toEditTour(data.item.id)" class="w-100 btn btn-travel mr-1 mb-1 btn-travel">\n                        Редактировать\n                    </b-button>\n                </b-input-group>\n            </template>\n            <template v-slot:cell(action2)="data">\n                <b-input-group size="sm" >\n                    <b-button v-if="data.item.deleted_at==null" @click="destroy(data.item.id)" class="btn btn-info mr-1 mb-1 btn-travel w-100"\n                              :disabled="data.item.id===null">\n                            Удалить\n                    </b-button>\n                </b-input-group>\n            </template>\n\x3c!--            <template v-slot:row-details="row">--\x3e\n\x3c!--                <b-card>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Даты тура" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <VueHotelDatepicker--\x3e\n\x3c!--                                    ref="datepickerId"--\x3e\n\x3c!--                                    :startDate="row.item.StartAt"--\x3e\n\x3c!--                                    :endDate="row.item.EndAt"--\x3e\n\x3c!--                                    :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                                    :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                                    :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                                    :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                                    :fromText="\'С\'"--\x3e\n\x3c!--                                    :toText="\'По\'"--\x3e\n\x3c!--                                    :resetText="\'Очистить\'"--\x3e\n\x3c!--                                    :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                                    :mobile="\'mobile\'"--\x3e\n\x3c!--                                    class="w-100 tours"--\x3e\n\x3c!--                                    @update="save($event,row.item.id,\'date_range\')"--\x3e\n\x3c!--                                />--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Страна" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.country"--\x3e\n\x3c!--                                    :options="countries"--\x3e\n\x3c!--                                    :option-height="25"--\x3e\n\x3c!--                                    placeholder="Выберите страну"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :loading="isCountriesLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    @input="save($event,row.item.id,\'country\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                        <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Курорт" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    :value="row.item.TourInfo.resort"--\x3e\n\x3c!--                                    :options="cities"--\x3e\n\x3c!--                                    placeholder="Введите название курорта"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                                    @input="save($event,row.item.id,\'resort\')"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    :preselectFirst="true"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Отель" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    :value="row.item.TourInfo.hotel"--\x3e\n\x3c!--                                    :options="hotels"--\x3e\n\x3c!--                                    placeholder="Введите название отеля"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :limit="2"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    :loading="isCountriesLoading || isHotelsLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading || isHotelsLoading"--\x3e\n\x3c!--                                    @input="save($event, row.item.id,\'hotel\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="selection" slot-scope="{ values, search, isOpen }">--\x3e\n\x3c!--                                    <span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeHotels}} {{values.length | pluralizeChoose}}--\x3e\n\x3c!--                                    </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                    <span class="option__desc">--\x3e\n\x3c!--                                        <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                                        <span class="option__title" style="float:right" v-if="props.option.CommonRate!=0">{{ props.option.CommonRate }}</span>--\x3e\n\x3c!--                                        <span class="values__hotel-rating" style="float:right" v-if="props.option.StarName">{{ props.option.StarName }}</span>--\x3e\n\x3c!--                                    </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <div class="option__desc">--\x3e\n\x3c!--                                            <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                                            <span class="option__title" style="float:right" v-if="props.option.CommonRate!=0">{{ props.option.CommonRate }}</span>--\x3e\n\x3c!--                                            <span class="values__hotel-rating" style="float:right" v-if="props.option.StarName">{{ props.option.StarName }}</span>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Категория номера" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    label="Категория номера"--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.room_type"--\x3e\n\x3c!--                                    placeholder="Категория номера"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value, row.item.id,\'room_type\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Питание" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.meal"--\x3e\n\x3c!--                                    :options="meals"--\x3e\n\x3c!--                                    :option-height="25"--\x3e\n\x3c!--                                    placeholder="Выберите питание"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    @input="save($event, row.item.id,\'meal\')"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                            <span class="option__title">{{props.option.Name}}</span>--\x3e\n\x3c!--                                        </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <div>--\x3e\n\x3c!--                                            <div class="option__desc">--\x3e\n\x3c!--                                                <span class="option__title">{{props.option.Name}}</span>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="row align-items-center m-auto" style="width: 100%; height: 100%">--\x3e\n\x3c!--                                                <p class="" style="font-size: 12px; margin:0px;">{{props.option.desc}}</p>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Цена" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.price"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value,row.item.id,\'price\')"--\x3e\n\x3c!--                                    placeholder="Цена"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Выплачено" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.paid"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value,row.item.id,\'paid\')"--\x3e\n\x3c!--                                    placeholder="Выплачено"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Остаток" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.left"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    disabled--\x3e\n\x3c!--                                    placeholder="Остаток"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Дополнительные услуги" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                 <b-form-textarea rows="4" cols="80"--\x3e\n\x3c!--                                           class="form-control"--\x3e\n\x3c!--                                           placeholder="Дополнительные услуги"--\x3e\n\x3c!--                                           v-model="row.item.TourInfo.services"--\x3e\n\x3c!--                                           style="padding: 5px 15px; border: 1px solid #f08b23;border-radius: 20px"--\x3e\n\x3c!--                                 >--\x3e\n\x3c!--                                 </b-form-textarea>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Авиабилеты</label>--\x3e\n\x3c!--                            <avia-tickets-list :avia_tickets="row.item.TourInfo.avia_tickets"></avia-tickets-list>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Пассажиры</label>--\x3e\n\x3c!--                            <passengers-list :passengers="row.item.TourInfo.passengers"></passengers-list>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Файлы для клиента</label>--\x3e\n\x3c!--                            <div--\x3e\n\x3c!--                                class="list-group-item"--\x3e\n\x3c!--                                v-for="(file, index) in row.item.TourInfo.files"--\x3e\n\x3c!--                                :key="file.name"--\x3e\n\x3c!--                            >--\x3e\n\x3c!--                                <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'file\'">--\x3e\n\x3c!--                                    <div class="col-4 text-center">--\x3e\n\x3c!--                                        <img class="preview" v-if="/\\.(jpe?g|png|svg)$/i.test(file.name)" :src="file.path"/>--\x3e\n\x3c!--                                        <img class="preview" v-else src="/images/LOGO-1.png"/>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <div class="col-8">--\x3e\n\x3c!--                                        <div>--\x3e\n\x3c!--                                            <p class="control-label">{{file.name}}</p>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                                <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'audio\'">--\x3e\n\x3c!--                                    <div class="audio-container w-100">--\x3e\n\x3c!--                                        <audio-player :audio="file" class="w-100" type="url"></audio-player>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                            <div class="form-group row mt-2">--\x3e\n\x3c!--                                <div class="col-md-12">--\x3e\n\x3c!--                                    <div class="large-12 medium-12 small-12 filezone">--\x3e\n\x3c!--                                        <input type="file" id="files" :ref="\'tour_files\'+row.item.id" multiple v-on:change="handleEditFiles(row.item)"/>--\x3e\n\x3c!--                                        <p>--\x3e\n\x3c!--                                            Перетащите файл(ы) сюда<br>или нажмите для поиска--\x3e\n\x3c!--                                        </p>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <label class="control-label">Или запишите голосовое сообщение</label>--\x3e\n\x3c!--                                    <div class="d-flex justify-content-center mt-2">--\x3e\n\x3c!--                                        <vue-record-audio :mode="\'press\'" @stream="onStream" @result="onEditResult($event, row.item)"/>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <div class="file-listing">--\x3e\n\x3c!--                                        <div--\x3e\n\x3c!--                                            class="list-group-item"--\x3e\n\x3c!--                                            v-for="(file, index) in row.item.TourInfo.files"--\x3e\n\x3c!--                                            :key="file.name"--\x3e\n\x3c!--                                        >--\x3e\n\x3c!--                                            <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'file\'">--\x3e\n\x3c!--                                                <div class="col-4 text-center">--\x3e\n\x3c!--                                                    <img class="preview" v-if="/\\.(jpe?g|png|svg)$/i.test(file.name)" :src="file.path"/>--\x3e\n\x3c!--                                                    <img class="preview" v-else src="/images/LOGO-1.png"/>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                                <div class="col-8">--\x3e\n\x3c!--                                                    <p class="control-label">{{file.name}}</p>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'audio\'">--\x3e\n\x3c!--                                                <div class="col-12">--\x3e\n\x3c!--                                                    <audio-player :audio="file"></audio-player>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="remove-container">--\x3e\n\x3c!--                                                <a class="remove" v-on:click="deleteFile(file, index)" v-if="loadingFiles == false">Удалить</a>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--&lt;!&ndash;                                    <div class="file-listing">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                        <div class="list-group-item" v-for="(file, index) in row.item.new_files">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                            <div class="row m-auto w-100 align-items-center justify-content-center">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                <div class="col-4 text-center">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <img class="preview" v-bind:ref="\'preview\'+parseInt(index)"/>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                <div class="col-8">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <div v-if="file.type==\'file\'">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                        <p class="control-label">{{file.data.name}}</p>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <div v-if="file.type==\'audio\'">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                        <audio-player :audio="file"></audio-player>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                            </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                            <div class="remove-container">&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                                <a class="remove" v-on:click="removeFile(new_files, index)" v-if="loadingFiles == false">Отменить</a>&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                            </div>&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                        </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                    </div>&ndash;&gt;--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                </b-card>--\x3e\n\x3c!--            </template>--\x3e\n            <template v-slot:table-busy>\n                <div class="text-center text-warning my-2">\n                    <b-spinner variant="warning" class="align-middle"/>\n                    <strong>Загрузка...</strong>\n                </div>\n            </template>\n        </b-table>\n    </div>\n</template>\n\n<script>\n    import {mask} from \'vue-the-mask\'\n    export default {\n        props: {\n            tours: {\n                type: Array,\n                required: true,\n                default: function(){\n                    return [];\n                }\n            },\n            loading: {\n                type: Boolean,\n                default: true\n            },\n            totalRows: {\n                type: Number,\n                required: true,\n                default: 0\n            },\n        },\n        data() {\n            return {\n                order_by: \'id\',\n                sortDesc: false,\n                // totalRows: 1,\n                currentPage: 1,\n                perPage: 5,\n                order_direction: \'asc\',\n                filter: null,\n                filterOn: [],\n\n                pageOptions: [5, 10, 15, 25, 50, 100],\n\n                fields: [\n                    {key: \'id\', label: \'ID\', sortable: true, order_direction: \'desc\'},\n                    {key: \'created_at\', label: \'Дата создания\', sortable: true, order_direction: \'desc\'},\n                    // {key: \'TourInfo.date_range\', label: \'Даты тура\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.date_range.start\', label: \'С\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.date_range.end\', label: \'По\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.country.Name\', label: \'Страна\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.resort.Name\', label: \'Курорт\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.price\', label: \'Цена\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.paid\', label: \'Выплачено\', sortable: true, order_direction: \'desc\'},\n                    {key: \'action1\', label: \'Показать\'},\n                    {key: \'action2\', label: \'Действия\'}\n                ],\n                meals: [\n                    { Id:\'115\', Name:\'AI\', desc:\'завтраки, обеды, ужины, напитки\'},\n                    { Id:\'114\',Name:\'BB\', desc:\'завтраки\'},\n                    { Id:\'112\',Name:\'FB\', desc:\'завтраки, обеды, ужины\'},\n                    { Id:\'121\',Name:\'FB+\', desc:\'завтраки, обеды, ужины - расширенное меню\'},\n                    { Id:\'113\',Name:\'HB\', desc:\'завтраки, ужины\'},\n                    { Id:\'122\',Name:\'HB+\', desc:\'завтраки, ужины - расширенное меню\'},\n                    { Id:\'117\',Name:\'RO\', desc:\'без питания\'},\n                    { Id:\'116\',Name:\'UAI\', desc:\'завтраки, обеды, ужины, напитки - расширенное меню\'},\n                    { Id:\'129\',Name:\'SC\', desc:\'самообслуживание\'},\n                ],\n                seconds:0,\n                interval:\'\',\n                flag:false,\n                loadingFiles:false\n            }\n        },\n        mounted() {\n\n        },\n        computed: {\n            isAdmin : function(){ return this.$store.getters.isAdmin},\n            isManager : function(){ return this.$store.getters.isManager},\n            sortOptions() {\n                return this.fields\n                    .filter(f => f.sortable)\n                    .map(f => {\n                        return {text: f.label, value: f.key}\n                    })\n            },\n\n            tourModule() {\n                return this.$store.getters.tourModule\n            },\n            countries() {\n                return this.$store.getters.countries;\n            },\n            cities() {\n                return this.$store.getters.cities;\n            },\n            hotels() {\n                return this.$store.getters.hotels;\n            },\n            branches(){\n                return this.$store.getters.branches\n            },\n\n            //loadings\n            isCountriesLoading() {\n                return this.$store.getters.isCountriesLoading;\n            },\n            isCitiesLoading() {\n                return this.$store.getters.isCitiesLoading;\n            },\n            isHotelsLoading() {\n                return this.$store.getters.isHotelsLoading;\n            },\n        },\n        methods: {\n            toEditTour(id) {\n                if(this.isAdmin){\n                    this.$router.push(\'/admin/client-tours/\'+this.$route.params.id+\'/edit/\'+id)\n                }\n                if(this.isManager){\n                    this.$router.push(\'/manager/client-tours/\'+this.$route.params.id+\'/edit/\'+id)\n                }\n            },\n            changeEditDateRange(date_object) {\n                this.save(date_object);\n            },\n            sendMessage(message) {\n                this.$notify({\n                    group: \'info\',\n                    type: \'travel\',\n                    title: \'Туры пользователей\',\n                    text: message\n                });\n            },\n\n            async destroy(id) {\n                this.$store.dispatch(\'forceDeleteClientTour\', {client_id:this.$route.params.id, id: id}).then(resp => {\n                    this.sendMessage(resp.data.message)\n                })\n            },\n            async save(value, id, key) {\n                this.$store.dispatch(\'saveClientTour\', {\n                    id: id,\n                    key: key,\n                    value: value\n                }).then(resp => {\n                    this.$store.commit(\'saveClientTour\', resp.data.user);\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            async saveInfo(value, id, key) {\n                if (key==\'date_range\')\n                {\n                    this.save(moment(value.start, "DD-MM-YYYY"), id, \'StartAt\')\n                    this.save(moment(value.end, "DD-MM-YYYY"), id, \'EndAt\')\n                }\n                var payload ={\n                    id: id,\n                    param: key,\n                    value: value\n                };\n                // if(key==\'files\')\n                // {\n                //     let payload = new FormData();\n                //     payload.append(\'id\',id);\n                //     payload.append(\'param\',key);\n                //     payload.append(\'value\',value);\n                //     payload.append("TourInfo", JSON.stringify(this.edit_tour));\n                //\n                //     for (var i = 0; i < this.new_files.length; i++) {\n                //         let file = this.new_files[i].data;\n                //\n                //         payload.append(\'files[\' + i + \']\', file);\n                //     }\n                // }\n                this.$store.dispatch(\'saveClientTourInfo\', payload).then(resp => {\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            async saveFiles(item, action) {\n                this.loadingFiles=true;\n                let payload = new FormData();\n                payload.append(\'id\',item.id);\n                payload.append(\'param\',\'files\');\n                // payload.append(\'value\', value);\n                payload.append(\'action\',action);\n                payload.append("TourInfo", JSON.stringify(item.TourInfo));\n                if(action == 1) {\n                    for (var i = 0; i < item.new_files.length; i++) {\n                        let file = item.new_files[i].data;\n\n                        payload.append(\'files[\' + i + \']\', file);\n                    }\n                }\n               else {\n                    for (var i = 0; i < item.delete_files.length; i++) {\n                        let file = item.delete_files[i].data;\n\n                        payload.append(\'files[\' + i + \']\', file);\n                    }\n                }\n                this.$store.dispatch(\'saveClientTourInfo\', payload).then(resp => {\n                    item.new_files=[];\n                    item.deleted_files=[];\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            onFiltered(filteredItems) {\n                this.totalRows = filteredItems.length;\n                this.currentPage = 1\n            },\n            chooseEditResortCountry(value, item){\n                item.TourInfo.resort={Name:\'Любой\'};\n                item.TourInfo.hotel={Name:\'Любой\'};\n                item.TourInfo.country = value;\n                this.$store.dispatch(\'getCities\', item.TourInfo.country.Id);\n                this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:\'0\', star_id:\'0\'});\n                this.saveInfo(value, item.id, \'country\');\n                this.saveInfo({Name:\'Любой\'}, item.id, \'resort\');\n                this.saveInfo({Name:\'Любой\'}, item.id, \'hotel\');\n            },\n            chooseEditResort(value, item) {\n                item.TourInfo.resort = value;\n                if(item.TourInfo.resort.Name != \'Любой\')\n                {\n                    var town_id = item.TourInfo.resort.Id;\n                    //поиск отелей по городам-курортам\n                    this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:town_id, star_id:\'0\'}).then(() => {\n                        if(this.hotels.findIndex(hotel=> hotel.Id == item.TourInfo.hotel.Id) == -1)\n                        {\n                            item.TourInfo.hotel = {Name:\'Любой\'};\n                            this.saveInfo({Name:\'Любой\'}, item.id, \'hotel\');\n                        }\n                    });\n                }\n                else {\n                    //если городов-курортов не выбрано, то поиск отелей по стране\n                    this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:\'0\', star_id:\'0\'});\n                }\n                this.saveInfo(value, item.id, \'resort\');\n            },\n            changeEditPrice(item){\n                item.TourInfo.left = item.TourInfo.price - item.TourInfo.paid;\n                this.saveInfo(item.TourInfo.left, item.id,\'left\')\n            },\n            handleEditFiles(item) {\n                let uploadedFiles = this.$refs[\'tour_files\'+ item.id].files;\n                for(var i = 0; i < uploadedFiles.length; i++) {\n                    if (/\\.(jpe?g|png|svg|pdf|txt|docx|doc)$/i.test(uploadedFiles[i].name))\n                    {\n                        var date = new Date();\n                        item.new_files.push({type:\'file\', name:uploadedFiles[i].name, data:uploadedFiles[i], date: date });\n                        item.TourInfo.files.push({type:\'file\', name:uploadedFiles[i].name, data:uploadedFiles[i], date: date });\n                        this.getImagePreviews(item.TourInfo.files);\n                        this.saveFiles(item, 1)\n                    }\n                    else\n                    {\n                        break;\n                    }\n                }\n            },\n            onEditResult(data, item) {\n                var time = Date.now();\n                var date = new Date();\n                item.new_files.push({\n                    type: \'audio\',\n                    name: \'record-\'+time+\'.mp3\',\n                    src: window.URL.createObjectURL(data),\n                    data: data,\n                    date: date,\n                    seconds: this.seconds\n                });\n                item.TourInfo.files.push({\n                    type: \'audio\',\n                    name: \'record-\'+time+\'.mp3\',\n                    src: window.URL.createObjectURL(data),\n                    data: data,\n                    date: date,\n                    seconds: this.seconds\n                });\n                this.countSeconds();\n                this.saveFiles(item, 1)\n                this.getImagePreviews(item.new_files);\n            },\n            deleteFile(file, key, item) {\n                item.delete_files.push(file);\n                item.TourInfo.files.splice( key, 1 );\n                this.saveFiles(item, 0)\n            },\n            getImagePreviews(arr) {\n                for ( let i = 0; i < arr.length; i++ ) {\n                    if ( /\\.(jpe?g|png|svg)$/i.test(arr[i].name)) {\n                        let reader = new FileReader();\n                        reader.addEventListener("load", function() {\n                            this.$refs[\'preview\'+parseInt(i)][0].src = reader.result;\n                        }.bind(this), false);\n                        reader.readAsDataURL(arr[i].data);\n                    }\n                    else {\n                        this.$nextTick(function() {\n                            this.$refs[\'preview\'+parseInt(i)][0].src = \'/images/LOGO-1.png\';\n                        });\n                    }\n                }\n            },\n            onStream(stream) {\n                this.countSeconds();\n                console.log(\'Got a stream object:\', stream);\n            },\n            countSeconds() {\n                this.flag = !this.flag;\n                if (this.flag == true) {\n                    this.seconds=0;\n                    this.interval = setInterval(this.incrementSeconds, 1000);\n                }\n                else {\n                    clearInterval(this.interval)\n                }\n            },\n            incrementSeconds() {\n                this.seconds += 1;\n            },\n        },\n        directives: {mask}\n    }\n<\/script>\n<style scoped>\n    .btn-travel{\n        background: #e17e4e;\n        background-color: rgb(225, 126, 78);\n        background-position-x: 0%;\n        background-position-y: 0%;\n        background-image: none;\n        background-size: auto;\n        background-image: linear-gradient(to bottom left, #e17e4e, #ffbf00, #e17e4e);\n        background-size: 210% 210%;\n        background-position: top right;\n        background-color: #e17e4e;\n        transition: all 0.15s ease;\n        box-shadow: none;\n        color: #ffffff;\n        max-width: 300px;\n        border: none;\n    }\n</style>\n<style>\n    .page-item.active .page-link {\n        background: #f08b23;\n        border: 1px solid #f08b23;\n        transition: all 0.15s ease;\n        box-shadow: none;\n        color: #ffffff;\n    }\n    .tours .vhd-input {\n        min-width: 100%;\n    }\n</style>\n'],sourceRoot:""}]);const r=a},1282:(e,n,t)=>{t.d(n,{A:()=>r});var s=t(45627),o=t.n(s),i=t(76798),a=t.n(i)()(o());a.push([e.id,".page-item.active .page-link{background:#f08b23;border:1px solid #f08b23;box-shadow:none;color:#fff;transition:all .15s ease}.tours .vhd-input{min-width:100%}","",{version:3,sources:["webpack://./resources/js/desktop/pages/Manager/Tours/Table.vue"],names:[],mappings:"AAw8BA,6BACA,kBAAA,CACA,wBAAA,CAEA,eAAA,CACA,UAAA,CAFA,wBAGA,CACA,kBACA,cACA",sourcesContent:['<template>\n    <div class="w-100 m-auto">\n        <b-row>\n            <b-col lg="6" class="my-1">\n                <b-form-group\n                    label="Сортировка"\n                    label-cols-sm="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="order_bySelect1"\n                    class="mb-0"\n                >\n                    <b-input-group size="sm">\n                        <b-form-select v-model="order_by" id="order_bySelect1" :options="sortOptions" class="w-75">\n                            <template v-slot:first>\n                                <option value="">-- none --</option>\n                            </template>\n                        </b-form-select>\n                        <b-form-select v-model="sortDesc" size="sm" :disabled="!order_by" class="w-25">\n                            <option :value="false">Asc</option>\n                            <option :value="true">Desc</option>\n                        </b-form-select>\n                    </b-input-group>\n                </b-form-group>\n            </b-col>\n\n            <b-col lg="6" class="my-1">\n                <b-form-group\n                    label="Поиск"\n                    label-cols-sm="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="filterInput"\n                    class="mb-0"\n                >\n                    <b-input-group size="sm">\n                        <b-form-input\n                            v-model="filter"\n                            type="search"\n                            id="filterInput"\n                            placeholder="Введите для поиска"\n                        />\n                        <b-input-group-append>\n                            <b-button :disabled="!filter" @click="filter = \'\'">Очистить</b-button>\n                        </b-input-group-append>\n                    </b-input-group>\n                </b-form-group>\n            </b-col>\n\n            <b-col sm="5" md="6" class="my-1">\n                <b-form-group\n                    label="На странице"\n                    label-cols-sm="6"\n                    label-cols-md="4"\n                    label-cols-lg="3"\n                    label-align-sm="right"\n                    label-size="sm"\n                    label-for="perPageSelect1"\n                    class="mb-0"\n                >\n                    <b-form-select\n                        v-model="perPage"\n                        id="perPageSelect1"\n                        size="sm"\n                        :options="pageOptions"\n                    />\n                </b-form-group>\n            </b-col>\n\n            <b-col sm="7" md="6" class="my-1">\n                <b-pagination\n                    v-model="currentPage"\n                    :total-rows="totalRows"\n                    :per-page="perPage"\n                    align="fill"\n                    size="sm"\n                    class="my-0"\n                >\n                </b-pagination>\n            </b-col>\n        </b-row>\n        <b-table\n            show-empty\n            small\n            stacked="md"\n            :items="tours"\n            :fields="fields"\n            :current-page="currentPage"\n            :per-page="perPage"\n            :filter="filter"\n            :filterIncludedFields="filterOn"\n            :sort-by.sync="order_by"\n            :sort-desc.sync="sortDesc"\n            :sort-direction="order_direction"\n            @filtered="onFiltered"\n            :busy="loading"\n            empty-text="Нет записей для отображения"\n            empty-filtered-text="Нет записей, соответствующих вашему запросу"\n        >\n            <template v-slot:cell(created_at)="data">\n                {{data.item.created_at | moment(\'DD.MM.YYYY\')}}\n            </template>\n\x3c!--            <template v-slot:cell(TourInfo.date_range)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <VueHotelDatepicker--\x3e\n\x3c!--                        ref="datepickerId"--\x3e\n\x3c!--                        :startDate="data.item.TourInfo.start"--\x3e\n\x3c!--                        :endDate="data.item.TourInfo.end"--\x3e\n\x3c!--                        :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                        :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                        :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                        :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                        :fromText="\'С\'"--\x3e\n\x3c!--                        :toText="\'По\'"--\x3e\n\x3c!--                        :resetText="\'Очистить\'"--\x3e\n\x3c!--                        :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                        :mobile="\'mobile\'"--\x3e\n\x3c!--                        class="w-100"--\x3e\n\x3c!--                        @update="save($event,data.item.id,\'date_range\')"--\x3e\n\x3c!--                    />--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.country)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        v-model="data.item.TourInfo.country"--\x3e\n\x3c!--                        :options="countries"--\x3e\n\x3c!--                        :option-height="25"--\x3e\n\x3c!--                        placeholder="Выберите страну"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :loading="isCountriesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'country\')"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                        <template slot="option" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.resort)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        :value="data.item.TourInfo.resort"--\x3e\n\x3c!--                        :options="cities"--\x3e\n\x3c!--                        placeholder="Введите название курорта"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                        :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'resort\')"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        :preselectFirst="true"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.price)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.price"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'price\')"--\x3e\n\x3c!--                                  placeholder="Цена"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.paid)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.paid"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'paid\')"--\x3e\n\x3c!--                                  placeholder="Выплачено"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>  <template v-slot:cell(TourInfo.date_range)="data">--\x3e\n\x3c!--            <b-input-group size="sm">--\x3e\n\x3c!--                <VueHotelDatepicker--\x3e\n\x3c!--                    ref="datepickerId"--\x3e\n\x3c!--                    :startDate="data.item.TourInfo.start"--\x3e\n\x3c!--                    :endDate="data.item.TourInfo.end"--\x3e\n\x3c!--                    :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                    :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                    :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                    :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                    :fromText="\'С\'"--\x3e\n\x3c!--                    :toText="\'По\'"--\x3e\n\x3c!--                    :resetText="\'Очистить\'"--\x3e\n\x3c!--                    :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                    :mobile="\'mobile\'"--\x3e\n\x3c!--                    class="w-100"--\x3e\n\x3c!--                    @update="save($event,data.item.id,\'date_range\')"--\x3e\n\x3c!--                />--\x3e\n\x3c!--            </b-input-group>--\x3e\n\x3c!--        </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.country)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        v-model="data.item.TourInfo.country"--\x3e\n\x3c!--                        :options="countries"--\x3e\n\x3c!--                        :option-height="25"--\x3e\n\x3c!--                        placeholder="Выберите страну"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :loading="isCountriesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'country\')"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                        <template slot="option" slot-scope="props">--\x3e\n\x3c!--                            <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                            <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                        </template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.resort)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <multiselect--\x3e\n\x3c!--                        :value="data.item.TourInfo.resort"--\x3e\n\x3c!--                        :options="cities"--\x3e\n\x3c!--                        placeholder="Введите название курорта"--\x3e\n\x3c!--                        :show-labels="false"--\x3e\n\x3c!--                        :maxHeight="200"--\x3e\n\x3c!--                        label="Name"--\x3e\n\x3c!--                        track-by="Name"--\x3e\n\x3c!--                        :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                        :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                        @input="save($event,data.item.id,\'resort\')"--\x3e\n\x3c!--                        :allow-empty="false"--\x3e\n\x3c!--                        :preselectFirst="true"--\x3e\n\x3c!--                    >--\x3e\n\x3c!--                        <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                    </multiselect>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.price)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.price"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'price\')"--\x3e\n\x3c!--                                  placeholder="Цена"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n\x3c!--            <template v-slot:cell(TourInfo.paid)="data">--\x3e\n\x3c!--                <b-input-group size="sm">--\x3e\n\x3c!--                    <b-form-input :value="data.item.TourInfo.paid"--\x3e\n\x3c!--                                  type="number"--\x3e\n\x3c!--                                  min="0"--\x3e\n\x3c!--                                  @blur="save($event.target.value,data.item.id,\'paid\')"--\x3e\n\x3c!--                                  placeholder="Выплачено"/>--\x3e\n\x3c!--                </b-input-group>--\x3e\n\x3c!--            </template>--\x3e\n            <template v-slot:cell(action1)="data">\n                <b-input-group size="sm">\n\x3c!--                    <b-button @click="data.toggleDetails" class="w-100 btn btn-travel mr-1 mb-1 btn-travel">--\x3e\n\x3c!--                        {{ data.detailsShowing ? \'Свернуть\' : \'Редактировать\' }}--\x3e\n\x3c!--                    </b-button> --\x3e\n                    <b-button @click="toEditTour(data.item.id)" class="w-100 btn btn-travel mr-1 mb-1 btn-travel">\n                        Редактировать\n                    </b-button>\n                </b-input-group>\n            </template>\n            <template v-slot:cell(action2)="data">\n                <b-input-group size="sm" >\n                    <b-button v-if="data.item.deleted_at==null" @click="destroy(data.item.id)" class="btn btn-info mr-1 mb-1 btn-travel w-100"\n                              :disabled="data.item.id===null">\n                            Удалить\n                    </b-button>\n                </b-input-group>\n            </template>\n\x3c!--            <template v-slot:row-details="row">--\x3e\n\x3c!--                <b-card>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Даты тура" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <VueHotelDatepicker--\x3e\n\x3c!--                                    ref="datepickerId"--\x3e\n\x3c!--                                    :startDate="row.item.StartAt"--\x3e\n\x3c!--                                    :endDate="row.item.EndAt"--\x3e\n\x3c!--                                    :placeholder="\'Даты тура\'"--\x3e\n\x3c!--                                    :format="\'DD/MM/YYYY\'"--\x3e\n\x3c!--                                    :weekList="[\'Вс.\', \'Пн.\', \'Вт.\', \'Ср.\', \'Чт.\', \'Пт.\', \'Сб.\']"--\x3e\n\x3c!--                                    :monthList="[\'Янв.\', \'Фев.\', \'Мар.\', \'Апр.\', \'Май.\', \'Июн.\', \'Июл.\', \'Авг.\', \'Сен.\', \'Окт\', \'Ноя.\', \'Дек.\']"--\x3e\n\x3c!--                                    :fromText="\'С\'"--\x3e\n\x3c!--                                    :toText="\'По\'"--\x3e\n\x3c!--                                    :resetText="\'Очистить\'"--\x3e\n\x3c!--                                    :confirmText="\'Подтвердить\'"--\x3e\n\x3c!--                                    :mobile="\'mobile\'"--\x3e\n\x3c!--                                    class="w-100 tours"--\x3e\n\x3c!--                                    @update="save($event,row.item.id,\'date_range\')"--\x3e\n\x3c!--                                />--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Страна" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.country"--\x3e\n\x3c!--                                    :options="countries"--\x3e\n\x3c!--                                    :option-height="25"--\x3e\n\x3c!--                                    placeholder="Выберите страну"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :loading="isCountriesLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    @input="save($event,row.item.id,\'country\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                        <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <b :class="\'tc-flag-\'+props.option.Id"></b>--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                            </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Курорт" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    :value="row.item.TourInfo.resort"--\x3e\n\x3c!--                                    :options="cities"--\x3e\n\x3c!--                                    placeholder="Введите название курорта"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    :loading="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading || isCitiesLoading"--\x3e\n\x3c!--                                    @input="save($event,row.item.id,\'resort\')"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    :preselectFirst="true"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="selection" slot-scope="{ values, search, isOpen }"><span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeResorts }} {{values.length | pluralizeChoose}}</span></template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Отель" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    :value="row.item.TourInfo.hotel"--\x3e\n\x3c!--                                    :options="hotels"--\x3e\n\x3c!--                                    placeholder="Введите название отеля"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :limit="2"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    :loading="isCountriesLoading || isHotelsLoading"--\x3e\n\x3c!--                                    :disabled="isCountriesLoading || isHotelsLoading"--\x3e\n\x3c!--                                    @input="save($event, row.item.id,\'hotel\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="selection" slot-scope="{ values, search, isOpen }">--\x3e\n\x3c!--                                    <span class="multiselect__single" v-if="values.length>3 && !isOpen">{{ values.length }} {{values.length | pluralizeHotels}} {{values.length | pluralizeChoose}}--\x3e\n\x3c!--                                    </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                    <span class="option__desc">--\x3e\n\x3c!--                                        <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                                        <span class="option__title" style="float:right" v-if="props.option.CommonRate!=0">{{ props.option.CommonRate }}</span>--\x3e\n\x3c!--                                        <span class="values__hotel-rating" style="float:right" v-if="props.option.StarName">{{ props.option.StarName }}</span>--\x3e\n\x3c!--                                    </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <div class="option__desc">--\x3e\n\x3c!--                                            <span class="option__title">{{ props.option.Name }}</span>--\x3e\n\x3c!--                                            <span class="option__title" style="float:right" v-if="props.option.CommonRate!=0">{{ props.option.CommonRate }}</span>--\x3e\n\x3c!--                                            <span class="values__hotel-rating" style="float:right" v-if="props.option.StarName">{{ props.option.StarName }}</span>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Категория номера" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    label="Категория номера"--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.room_type"--\x3e\n\x3c!--                                    placeholder="Категория номера"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value, row.item.id,\'room_type\')"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Питание" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <multiselect--\x3e\n\x3c!--                                    v-model="row.item.TourInfo.meal"--\x3e\n\x3c!--                                    :options="meals"--\x3e\n\x3c!--                                    :option-height="25"--\x3e\n\x3c!--                                    placeholder="Выберите питание"--\x3e\n\x3c!--                                    :show-labels="false"--\x3e\n\x3c!--                                    :maxHeight="200"--\x3e\n\x3c!--                                    label="Name"--\x3e\n\x3c!--                                    track-by="Name"--\x3e\n\x3c!--                                    :close-on-select="true" :clear-on-select="true"--\x3e\n\x3c!--                                    @input="save($event, row.item.id,\'meal\')"--\x3e\n\x3c!--                                    :allow-empty="false"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                    <template slot="singleLabel" slot-scope="props">--\x3e\n\x3c!--                                        <span class="option__desc">--\x3e\n\x3c!--                                            <span class="option__title">{{props.option.Name}}</span>--\x3e\n\x3c!--                                        </span>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                    <template slot="option" slot-scope="props">--\x3e\n\x3c!--                                        <div>--\x3e\n\x3c!--                                            <div class="option__desc">--\x3e\n\x3c!--                                                <span class="option__title">{{props.option.Name}}</span>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="row align-items-center m-auto" style="width: 100%; height: 100%">--\x3e\n\x3c!--                                                <p class="" style="font-size: 12px; margin:0px;">{{props.option.desc}}</p>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </template>--\x3e\n\x3c!--                                </multiselect>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Цена" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.price"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value,row.item.id,\'price\')"--\x3e\n\x3c!--                                    placeholder="Цена"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Выплачено" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.paid"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    @blur="save($event.target.value,row.item.id,\'paid\')"--\x3e\n\x3c!--                                    placeholder="Выплачено"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-4 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Остаток" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                <b-form-input--\x3e\n\x3c!--                                    :value="row.item.TourInfo.left"--\x3e\n\x3c!--                                    type="number"--\x3e\n\x3c!--                                    min="0"--\x3e\n\x3c!--                                    class="mb-0 travel-input"--\x3e\n\x3c!--                                    disabled--\x3e\n\x3c!--                                    placeholder="Остаток"--\x3e\n\x3c!--                                >--\x3e\n\x3c!--                                </b-form-input>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                    <div class="row align-items-center justify-content-center m-auto">--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <b-form-group label="Дополнительные услуги" label-size="sm" class="mb-0">--\x3e\n\x3c!--                                 <b-form-textarea rows="4" cols="80"--\x3e\n\x3c!--                                           class="form-control"--\x3e\n\x3c!--                                           placeholder="Дополнительные услуги"--\x3e\n\x3c!--                                           v-model="row.item.TourInfo.services"--\x3e\n\x3c!--                                           style="padding: 5px 15px; border: 1px solid #f08b23;border-radius: 20px"--\x3e\n\x3c!--                                 >--\x3e\n\x3c!--                                 </b-form-textarea>--\x3e\n\x3c!--                            </b-form-group>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Авиабилеты</label>--\x3e\n\x3c!--                            <avia-tickets-list :avia_tickets="row.item.TourInfo.avia_tickets"></avia-tickets-list>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Пассажиры</label>--\x3e\n\x3c!--                            <passengers-list :passengers="row.item.TourInfo.passengers"></passengers-list>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div class="col-sm-12 px-1 col-md-12 mb-2">--\x3e\n\x3c!--                            <label class="control-label">Файлы для клиента</label>--\x3e\n\x3c!--                            <div--\x3e\n\x3c!--                                class="list-group-item"--\x3e\n\x3c!--                                v-for="(file, index) in row.item.TourInfo.files"--\x3e\n\x3c!--                                :key="file.name"--\x3e\n\x3c!--                            >--\x3e\n\x3c!--                                <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'file\'">--\x3e\n\x3c!--                                    <div class="col-4 text-center">--\x3e\n\x3c!--                                        <img class="preview" v-if="/\\.(jpe?g|png|svg)$/i.test(file.name)" :src="file.path"/>--\x3e\n\x3c!--                                        <img class="preview" v-else src="/images/LOGO-1.png"/>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <div class="col-8">--\x3e\n\x3c!--                                        <div>--\x3e\n\x3c!--                                            <p class="control-label">{{file.name}}</p>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                                <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'audio\'">--\x3e\n\x3c!--                                    <div class="audio-container w-100">--\x3e\n\x3c!--                                        <audio-player :audio="file" class="w-100" type="url"></audio-player>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                            <div class="form-group row mt-2">--\x3e\n\x3c!--                                <div class="col-md-12">--\x3e\n\x3c!--                                    <div class="large-12 medium-12 small-12 filezone">--\x3e\n\x3c!--                                        <input type="file" id="files" :ref="\'tour_files\'+row.item.id" multiple v-on:change="handleEditFiles(row.item)"/>--\x3e\n\x3c!--                                        <p>--\x3e\n\x3c!--                                            Перетащите файл(ы) сюда<br>или нажмите для поиска--\x3e\n\x3c!--                                        </p>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <label class="control-label">Или запишите голосовое сообщение</label>--\x3e\n\x3c!--                                    <div class="d-flex justify-content-center mt-2">--\x3e\n\x3c!--                                        <vue-record-audio :mode="\'press\'" @stream="onStream" @result="onEditResult($event, row.item)"/>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--                                    <div class="file-listing">--\x3e\n\x3c!--                                        <div--\x3e\n\x3c!--                                            class="list-group-item"--\x3e\n\x3c!--                                            v-for="(file, index) in row.item.TourInfo.files"--\x3e\n\x3c!--                                            :key="file.name"--\x3e\n\x3c!--                                        >--\x3e\n\x3c!--                                            <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'file\'">--\x3e\n\x3c!--                                                <div class="col-4 text-center">--\x3e\n\x3c!--                                                    <img class="preview" v-if="/\\.(jpe?g|png|svg)$/i.test(file.name)" :src="file.path"/>--\x3e\n\x3c!--                                                    <img class="preview" v-else src="/images/LOGO-1.png"/>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                                <div class="col-8">--\x3e\n\x3c!--                                                    <p class="control-label">{{file.name}}</p>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="row m-auto w-100 align-items-center justify-content-center" v-if="file.type==\'audio\'">--\x3e\n\x3c!--                                                <div class="col-12">--\x3e\n\x3c!--                                                    <audio-player :audio="file"></audio-player>--\x3e\n\x3c!--                                                </div>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                            <div class="remove-container">--\x3e\n\x3c!--                                                <a class="remove" v-on:click="deleteFile(file, index)" v-if="loadingFiles == false">Удалить</a>--\x3e\n\x3c!--                                            </div>--\x3e\n\x3c!--                                        </div>--\x3e\n\x3c!--                                    </div>--\x3e\n\x3c!--&lt;!&ndash;                                    <div class="file-listing">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                        <div class="list-group-item" v-for="(file, index) in row.item.new_files">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                            <div class="row m-auto w-100 align-items-center justify-content-center">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                <div class="col-4 text-center">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <img class="preview" v-bind:ref="\'preview\'+parseInt(index)"/>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                <div class="col-8">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <div v-if="file.type==\'file\'">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                        <p class="control-label">{{file.data.name}}</p>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    <div v-if="file.type==\'audio\'">&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                        <audio-player :audio="file"></audio-player>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                    </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                                </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                            </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                            <div class="remove-container">&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                                <a class="remove" v-on:click="removeFile(new_files, index)" v-if="loadingFiles == false">Отменить</a>&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;&lt;!&ndash;                                            </div>&ndash;&gt;&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                        </div>&ndash;&gt;--\x3e\n\x3c!--&lt;!&ndash;                                    </div>&ndash;&gt;--\x3e\n\x3c!--                                </div>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                </b-card>--\x3e\n\x3c!--            </template>--\x3e\n            <template v-slot:table-busy>\n                <div class="text-center text-warning my-2">\n                    <b-spinner variant="warning" class="align-middle"/>\n                    <strong>Загрузка...</strong>\n                </div>\n            </template>\n        </b-table>\n    </div>\n</template>\n\n<script>\n    import {mask} from \'vue-the-mask\'\n    export default {\n        props: {\n            tours: {\n                type: Array,\n                required: true,\n                default: function(){\n                    return [];\n                }\n            },\n            loading: {\n                type: Boolean,\n                default: true\n            },\n            totalRows: {\n                type: Number,\n                required: true,\n                default: 0\n            },\n        },\n        data() {\n            return {\n                order_by: \'id\',\n                sortDesc: false,\n                // totalRows: 1,\n                currentPage: 1,\n                perPage: 5,\n                order_direction: \'asc\',\n                filter: null,\n                filterOn: [],\n\n                pageOptions: [5, 10, 15, 25, 50, 100],\n\n                fields: [\n                    {key: \'id\', label: \'ID\', sortable: true, order_direction: \'desc\'},\n                    {key: \'created_at\', label: \'Дата создания\', sortable: true, order_direction: \'desc\'},\n                    // {key: \'TourInfo.date_range\', label: \'Даты тура\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.date_range.start\', label: \'С\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.date_range.end\', label: \'По\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.country.Name\', label: \'Страна\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.resort.Name\', label: \'Курорт\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.price\', label: \'Цена\', sortable: true, order_direction: \'desc\'},\n                    {key: \'TourInfo.paid\', label: \'Выплачено\', sortable: true, order_direction: \'desc\'},\n                    {key: \'action1\', label: \'Показать\'},\n                    {key: \'action2\', label: \'Действия\'}\n                ],\n                meals: [\n                    { Id:\'115\', Name:\'AI\', desc:\'завтраки, обеды, ужины, напитки\'},\n                    { Id:\'114\',Name:\'BB\', desc:\'завтраки\'},\n                    { Id:\'112\',Name:\'FB\', desc:\'завтраки, обеды, ужины\'},\n                    { Id:\'121\',Name:\'FB+\', desc:\'завтраки, обеды, ужины - расширенное меню\'},\n                    { Id:\'113\',Name:\'HB\', desc:\'завтраки, ужины\'},\n                    { Id:\'122\',Name:\'HB+\', desc:\'завтраки, ужины - расширенное меню\'},\n                    { Id:\'117\',Name:\'RO\', desc:\'без питания\'},\n                    { Id:\'116\',Name:\'UAI\', desc:\'завтраки, обеды, ужины, напитки - расширенное меню\'},\n                    { Id:\'129\',Name:\'SC\', desc:\'самообслуживание\'},\n                ],\n                seconds:0,\n                interval:\'\',\n                flag:false,\n                loadingFiles:false\n            }\n        },\n        mounted() {\n\n        },\n        computed: {\n            isAdmin : function(){ return this.$store.getters.isAdmin},\n            isManager : function(){ return this.$store.getters.isManager},\n            sortOptions() {\n                return this.fields\n                    .filter(f => f.sortable)\n                    .map(f => {\n                        return {text: f.label, value: f.key}\n                    })\n            },\n\n            tourModule() {\n                return this.$store.getters.tourModule\n            },\n            countries() {\n                return this.$store.getters.countries;\n            },\n            cities() {\n                return this.$store.getters.cities;\n            },\n            hotels() {\n                return this.$store.getters.hotels;\n            },\n            branches(){\n                return this.$store.getters.branches\n            },\n\n            //loadings\n            isCountriesLoading() {\n                return this.$store.getters.isCountriesLoading;\n            },\n            isCitiesLoading() {\n                return this.$store.getters.isCitiesLoading;\n            },\n            isHotelsLoading() {\n                return this.$store.getters.isHotelsLoading;\n            },\n        },\n        methods: {\n            toEditTour(id) {\n                if(this.isAdmin){\n                    this.$router.push(\'/admin/client-tours/\'+this.$route.params.id+\'/edit/\'+id)\n                }\n                if(this.isManager){\n                    this.$router.push(\'/manager/client-tours/\'+this.$route.params.id+\'/edit/\'+id)\n                }\n            },\n            changeEditDateRange(date_object) {\n                this.save(date_object);\n            },\n            sendMessage(message) {\n                this.$notify({\n                    group: \'info\',\n                    type: \'travel\',\n                    title: \'Туры пользователей\',\n                    text: message\n                });\n            },\n\n            async destroy(id) {\n                this.$store.dispatch(\'forceDeleteClientTour\', {client_id:this.$route.params.id, id: id}).then(resp => {\n                    this.sendMessage(resp.data.message)\n                })\n            },\n            async save(value, id, key) {\n                this.$store.dispatch(\'saveClientTour\', {\n                    id: id,\n                    key: key,\n                    value: value\n                }).then(resp => {\n                    this.$store.commit(\'saveClientTour\', resp.data.user);\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            async saveInfo(value, id, key) {\n                if (key==\'date_range\')\n                {\n                    this.save(moment(value.start, "DD-MM-YYYY"), id, \'StartAt\')\n                    this.save(moment(value.end, "DD-MM-YYYY"), id, \'EndAt\')\n                }\n                var payload ={\n                    id: id,\n                    param: key,\n                    value: value\n                };\n                // if(key==\'files\')\n                // {\n                //     let payload = new FormData();\n                //     payload.append(\'id\',id);\n                //     payload.append(\'param\',key);\n                //     payload.append(\'value\',value);\n                //     payload.append("TourInfo", JSON.stringify(this.edit_tour));\n                //\n                //     for (var i = 0; i < this.new_files.length; i++) {\n                //         let file = this.new_files[i].data;\n                //\n                //         payload.append(\'files[\' + i + \']\', file);\n                //     }\n                // }\n                this.$store.dispatch(\'saveClientTourInfo\', payload).then(resp => {\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            async saveFiles(item, action) {\n                this.loadingFiles=true;\n                let payload = new FormData();\n                payload.append(\'id\',item.id);\n                payload.append(\'param\',\'files\');\n                // payload.append(\'value\', value);\n                payload.append(\'action\',action);\n                payload.append("TourInfo", JSON.stringify(item.TourInfo));\n                if(action == 1) {\n                    for (var i = 0; i < item.new_files.length; i++) {\n                        let file = item.new_files[i].data;\n\n                        payload.append(\'files[\' + i + \']\', file);\n                    }\n                }\n               else {\n                    for (var i = 0; i < item.delete_files.length; i++) {\n                        let file = item.delete_files[i].data;\n\n                        payload.append(\'files[\' + i + \']\', file);\n                    }\n                }\n                this.$store.dispatch(\'saveClientTourInfo\', payload).then(resp => {\n                    item.new_files=[];\n                    item.deleted_files=[];\n                    this.sendMessage(resp.data.message)\n                });\n            },\n            onFiltered(filteredItems) {\n                this.totalRows = filteredItems.length;\n                this.currentPage = 1\n            },\n            chooseEditResortCountry(value, item){\n                item.TourInfo.resort={Name:\'Любой\'};\n                item.TourInfo.hotel={Name:\'Любой\'};\n                item.TourInfo.country = value;\n                this.$store.dispatch(\'getCities\', item.TourInfo.country.Id);\n                this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:\'0\', star_id:\'0\'});\n                this.saveInfo(value, item.id, \'country\');\n                this.saveInfo({Name:\'Любой\'}, item.id, \'resort\');\n                this.saveInfo({Name:\'Любой\'}, item.id, \'hotel\');\n            },\n            chooseEditResort(value, item) {\n                item.TourInfo.resort = value;\n                if(item.TourInfo.resort.Name != \'Любой\')\n                {\n                    var town_id = item.TourInfo.resort.Id;\n                    //поиск отелей по городам-курортам\n                    this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:town_id, star_id:\'0\'}).then(() => {\n                        if(this.hotels.findIndex(hotel=> hotel.Id == item.TourInfo.hotel.Id) == -1)\n                        {\n                            item.TourInfo.hotel = {Name:\'Любой\'};\n                            this.saveInfo({Name:\'Любой\'}, item.id, \'hotel\');\n                        }\n                    });\n                }\n                else {\n                    //если городов-курортов не выбрано, то поиск отелей по стране\n                    this.$store.dispatch(\'getHotels\', {country_id:item.TourInfo.country.Id, town_id:\'0\', star_id:\'0\'});\n                }\n                this.saveInfo(value, item.id, \'resort\');\n            },\n            changeEditPrice(item){\n                item.TourInfo.left = item.TourInfo.price - item.TourInfo.paid;\n                this.saveInfo(item.TourInfo.left, item.id,\'left\')\n            },\n            handleEditFiles(item) {\n                let uploadedFiles = this.$refs[\'tour_files\'+ item.id].files;\n                for(var i = 0; i < uploadedFiles.length; i++) {\n                    if (/\\.(jpe?g|png|svg|pdf|txt|docx|doc)$/i.test(uploadedFiles[i].name))\n                    {\n                        var date = new Date();\n                        item.new_files.push({type:\'file\', name:uploadedFiles[i].name, data:uploadedFiles[i], date: date });\n                        item.TourInfo.files.push({type:\'file\', name:uploadedFiles[i].name, data:uploadedFiles[i], date: date });\n                        this.getImagePreviews(item.TourInfo.files);\n                        this.saveFiles(item, 1)\n                    }\n                    else\n                    {\n                        break;\n                    }\n                }\n            },\n            onEditResult(data, item) {\n                var time = Date.now();\n                var date = new Date();\n                item.new_files.push({\n                    type: \'audio\',\n                    name: \'record-\'+time+\'.mp3\',\n                    src: window.URL.createObjectURL(data),\n                    data: data,\n                    date: date,\n                    seconds: this.seconds\n                });\n                item.TourInfo.files.push({\n                    type: \'audio\',\n                    name: \'record-\'+time+\'.mp3\',\n                    src: window.URL.createObjectURL(data),\n                    data: data,\n                    date: date,\n                    seconds: this.seconds\n                });\n                this.countSeconds();\n                this.saveFiles(item, 1)\n                this.getImagePreviews(item.new_files);\n            },\n            deleteFile(file, key, item) {\n                item.delete_files.push(file);\n                item.TourInfo.files.splice( key, 1 );\n                this.saveFiles(item, 0)\n            },\n            getImagePreviews(arr) {\n                for ( let i = 0; i < arr.length; i++ ) {\n                    if ( /\\.(jpe?g|png|svg)$/i.test(arr[i].name)) {\n                        let reader = new FileReader();\n                        reader.addEventListener("load", function() {\n                            this.$refs[\'preview\'+parseInt(i)][0].src = reader.result;\n                        }.bind(this), false);\n                        reader.readAsDataURL(arr[i].data);\n                    }\n                    else {\n                        this.$nextTick(function() {\n                            this.$refs[\'preview\'+parseInt(i)][0].src = \'/images/LOGO-1.png\';\n                        });\n                    }\n                }\n            },\n            onStream(stream) {\n                this.countSeconds();\n                console.log(\'Got a stream object:\', stream);\n            },\n            countSeconds() {\n                this.flag = !this.flag;\n                if (this.flag == true) {\n                    this.seconds=0;\n                    this.interval = setInterval(this.incrementSeconds, 1000);\n                }\n                else {\n                    clearInterval(this.interval)\n                }\n            },\n            incrementSeconds() {\n                this.seconds += 1;\n            },\n        },\n        directives: {mask}\n    }\n<\/script>\n<style scoped>\n    .btn-travel{\n        background: #e17e4e;\n        background-color: rgb(225, 126, 78);\n        background-position-x: 0%;\n        background-position-y: 0%;\n        background-image: none;\n        background-size: auto;\n        background-image: linear-gradient(to bottom left, #e17e4e, #ffbf00, #e17e4e);\n        background-size: 210% 210%;\n        background-position: top right;\n        background-color: #e17e4e;\n        transition: all 0.15s ease;\n        box-shadow: none;\n        color: #ffffff;\n        max-width: 300px;\n        border: none;\n    }\n</style>\n<style>\n    .page-item.active .page-link {\n        background: #f08b23;\n        border: 1px solid #f08b23;\n        transition: all 0.15s ease;\n        box-shadow: none;\n        color: #ffffff;\n    }\n    .tours .vhd-input {\n        min-width: 100%;\n    }\n</style>\n'],sourceRoot:""}]);const r=a},25170:(e,n,t)=>{t.r(n),t.d(n,{default:()=>_});var s=t(29928);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(){i=function(){return n};var e,n={},t=Object.prototype,s=t.hasOwnProperty,a=Object.defineProperty||function(e,n,t){e[n]=t.value},r="function"==typeof Symbol?Symbol:{},l=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",x=r.toStringTag||"@@toStringTag";function d(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{d({},"")}catch(e){d=function(e,n,t){return e[n]=t}}function u(e,n,t,s){var o=n&&n.prototype instanceof b?n:b,i=Object.create(o.prototype),r=new D(s||[]);return a(i,"_invoke",{value:C(e,t,r)}),i}function p(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=u;var m="suspendedStart",f="suspendedYield",g="executing",h="completed",v={};function b(){}function y(){}function w(){}var _={};d(_,l,(function(){return this}));var I=Object.getPrototypeOf,T=I&&I(I(O([])));T&&T!==t&&s.call(T,l)&&(_=T);var k=w.prototype=b.prototype=Object.create(_);function $(e){["next","throw","return"].forEach((function(n){d(e,n,(function(e){return this._invoke(n,e)}))}))}function L(e,n){function t(i,a,r,l){var c=p(e[i],e,a);if("throw"!==c.type){var x=c.arg,d=x.value;return d&&"object"==o(d)&&s.call(d,"__await")?n.resolve(d.__await).then((function(e){t("next",e,r,l)}),(function(e){t("throw",e,r,l)})):n.resolve(d).then((function(e){x.value=e,r(x)}),(function(e){return t("throw",e,r,l)}))}l(c.arg)}var i;a(this,"_invoke",{value:function(e,s){function o(){return new n((function(n,o){t(e,s,n,o)}))}return i=i?i.then(o,o):o()}})}function C(n,t,s){var o=m;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===h){if("throw"===i)throw a;return{value:e,done:!0}}for(s.method=i,s.arg=a;;){var r=s.delegate;if(r){var l=A(r,s);if(l){if(l===v)continue;return l}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(o===m)throw o=h,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);o=g;var c=p(n,t,s);if("normal"===c.type){if(o=s.done?h:f,c.arg===v)continue;return{value:c.arg,done:s.done}}"throw"===c.type&&(o=h,s.method="throw",s.arg=c.arg)}}}function A(n,t){var s=t.method,o=n.iterator[s];if(o===e)return t.delegate=null,"throw"===s&&n.iterator.return&&(t.method="return",t.arg=e,A(n,t),"throw"===t.method)||"return"!==s&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+s+"' method")),v;var i=p(o,n.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var a=i.arg;return a?a.done?(t[n.resultName]=a.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function N(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function z(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function O(n){if(n||""===n){var t=n[l];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,a=function t(){for(;++i<n.length;)if(s.call(n,i))return t.value=n[i],t.done=!1,t;return t.value=e,t.done=!0,t};return a.next=a}}throw new TypeError(o(n)+" is not iterable")}return y.prototype=w,a(k,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:y,configurable:!0}),y.displayName=d(w,x,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===y||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,d(e,x,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},$(L.prototype),d(L.prototype,c,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,s,o,i){void 0===i&&(i=Promise);var a=new L(u(e,t,s,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},$(k),d(k,x,"Generator"),d(k,l,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var s in n)t.push(s);return t.reverse(),function e(){for(;t.length;){var s=t.pop();if(s in n)return e.value=s,e.done=!1,e}return e.done=!0,e}},n.values=O,D.prototype={constructor:D,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(z),!n)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(s,o){return r.type="throw",r.arg=n,t.next=s,o&&(t.method="next",t.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],r=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=s.call(a,"catchLoc"),c=s.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&s.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),z(t),v}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var s=t.completion;if("throw"===s.type){var o=s.arg;z(t)}return o}}throw Error("illegal catch attempt")},delegateYield:function(n,t,s){return this.delegate={iterator:O(n),resultName:t,nextLoc:s},"next"===this.method&&(this.arg=e),v}},n}function a(e,n,t,s,o,i,a){try{var r=e[i](a),l=r.value}catch(e){return void t(e)}r.done?n(l):Promise.resolve(l).then(s,o)}function r(e){return function(){var n=this,t=arguments;return new Promise((function(s,o){var i=e.apply(n,t);function r(e){a(i,s,o,r,l,"next",e)}function l(e){a(i,s,o,r,l,"throw",e)}r(void 0)}))}}const l={props:{tours:{type:Array,required:!0,default:function(){return[]}},loading:{type:Boolean,default:!0},totalRows:{type:Number,required:!0,default:0}},data:function(){return{order_by:"id",sortDesc:!1,currentPage:1,perPage:5,order_direction:"asc",filter:null,filterOn:[],pageOptions:[5,10,15,25,50,100],fields:[{key:"id",label:"ID",sortable:!0,order_direction:"desc"},{key:"created_at",label:"Дата создания",sortable:!0,order_direction:"desc"},{key:"TourInfo.date_range.start",label:"С",sortable:!0,order_direction:"desc"},{key:"TourInfo.date_range.end",label:"По",sortable:!0,order_direction:"desc"},{key:"TourInfo.country.Name",label:"Страна",sortable:!0,order_direction:"desc"},{key:"TourInfo.resort.Name",label:"Курорт",sortable:!0,order_direction:"desc"},{key:"TourInfo.price",label:"Цена",sortable:!0,order_direction:"desc"},{key:"TourInfo.paid",label:"Выплачено",sortable:!0,order_direction:"desc"},{key:"action1",label:"Показать"},{key:"action2",label:"Действия"}],meals:[{Id:"115",Name:"AI",desc:"завтраки, обеды, ужины, напитки"},{Id:"114",Name:"BB",desc:"завтраки"},{Id:"112",Name:"FB",desc:"завтраки, обеды, ужины"},{Id:"121",Name:"FB+",desc:"завтраки, обеды, ужины - расширенное меню"},{Id:"113",Name:"HB",desc:"завтраки, ужины"},{Id:"122",Name:"HB+",desc:"завтраки, ужины - расширенное меню"},{Id:"117",Name:"RO",desc:"без питания"},{Id:"116",Name:"UAI",desc:"завтраки, обеды, ужины, напитки - расширенное меню"},{Id:"129",Name:"SC",desc:"самообслуживание"}],seconds:0,interval:"",flag:!1,loadingFiles:!1}},mounted:function(){},computed:{isAdmin:function(){return this.$store.getters.isAdmin},isManager:function(){return this.$store.getters.isManager},sortOptions:function(){return this.fields.filter((function(e){return e.sortable})).map((function(e){return{text:e.label,value:e.key}}))},tourModule:function(){return this.$store.getters.tourModule},countries:function(){return this.$store.getters.countries},cities:function(){return this.$store.getters.cities},hotels:function(){return this.$store.getters.hotels},branches:function(){return this.$store.getters.branches},isCountriesLoading:function(){return this.$store.getters.isCountriesLoading},isCitiesLoading:function(){return this.$store.getters.isCitiesLoading},isHotelsLoading:function(){return this.$store.getters.isHotelsLoading}},methods:{toEditTour:function(e){this.isAdmin&&this.$router.push("/admin/client-tours/"+this.$route.params.id+"/edit/"+e),this.isManager&&this.$router.push("/manager/client-tours/"+this.$route.params.id+"/edit/"+e)},changeEditDateRange:function(e){this.save(e)},sendMessage:function(e){this.$notify({group:"info",type:"travel",title:"Туры пользователей",text:e})},destroy:function(e){var n=this;return r(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.$store.dispatch("forceDeleteClientTour",{client_id:n.$route.params.id,id:e}).then((function(e){n.sendMessage(e.data.message)}));case 1:case"end":return t.stop()}}),t)})))()},save:function(e,n,t){var s=this;return r(i().mark((function o(){return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:s.$store.dispatch("saveClientTour",{id:n,key:t,value:e}).then((function(e){s.$store.commit("saveClientTour",e.data.user),s.sendMessage(e.data.message)}));case 1:case"end":return o.stop()}}),o)})))()},saveInfo:function(e,n,t){var s=this;return r(i().mark((function o(){var a;return i().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:"date_range"==t&&(s.save(moment(e.start,"DD-MM-YYYY"),n,"StartAt"),s.save(moment(e.end,"DD-MM-YYYY"),n,"EndAt")),a={id:n,param:t,value:e},s.$store.dispatch("saveClientTourInfo",a).then((function(e){s.sendMessage(e.data.message)}));case 3:case"end":return o.stop()}}),o)})))()},saveFiles:function(e,n){var t=this;return r(i().mark((function s(){var o,a,r,l;return i().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t.loadingFiles=!0,(o=new FormData).append("id",e.id),o.append("param","files"),o.append("action",n),o.append("TourInfo",JSON.stringify(e.TourInfo)),1==n)for(a=0;a<e.new_files.length;a++)r=e.new_files[a].data,o.append("files["+a+"]",r);else for(a=0;a<e.delete_files.length;a++)l=e.delete_files[a].data,o.append("files["+a+"]",l);t.$store.dispatch("saveClientTourInfo",o).then((function(n){e.new_files=[],e.deleted_files=[],t.sendMessage(n.data.message)}));case 8:case"end":return s.stop()}}),s)})))()},onFiltered:function(e){this.totalRows=e.length,this.currentPage=1},chooseEditResortCountry:function(e,n){n.TourInfo.resort={Name:"Любой"},n.TourInfo.hotel={Name:"Любой"},n.TourInfo.country=e,this.$store.dispatch("getCities",n.TourInfo.country.Id),this.$store.dispatch("getHotels",{country_id:n.TourInfo.country.Id,town_id:"0",star_id:"0"}),this.saveInfo(e,n.id,"country"),this.saveInfo({Name:"Любой"},n.id,"resort"),this.saveInfo({Name:"Любой"},n.id,"hotel")},chooseEditResort:function(e,n){var t=this;if(n.TourInfo.resort=e,"Любой"!=n.TourInfo.resort.Name){var s=n.TourInfo.resort.Id;this.$store.dispatch("getHotels",{country_id:n.TourInfo.country.Id,town_id:s,star_id:"0"}).then((function(){-1==t.hotels.findIndex((function(e){return e.Id==n.TourInfo.hotel.Id}))&&(n.TourInfo.hotel={Name:"Любой"},t.saveInfo({Name:"Любой"},n.id,"hotel"))}))}else this.$store.dispatch("getHotels",{country_id:n.TourInfo.country.Id,town_id:"0",star_id:"0"});this.saveInfo(e,n.id,"resort")},changeEditPrice:function(e){e.TourInfo.left=e.TourInfo.price-e.TourInfo.paid,this.saveInfo(e.TourInfo.left,e.id,"left")},handleEditFiles:function(e){for(var n=this.$refs["tour_files"+e.id].files,t=0;t<n.length&&/\.(jpe?g|png|svg|pdf|txt|docx|doc)$/i.test(n[t].name);t++){var s=new Date;e.new_files.push({type:"file",name:n[t].name,data:n[t],date:s}),e.TourInfo.files.push({type:"file",name:n[t].name,data:n[t],date:s}),this.getImagePreviews(e.TourInfo.files),this.saveFiles(e,1)}},onEditResult:function(e,n){var t=Date.now(),s=new Date;n.new_files.push({type:"audio",name:"record-"+t+".mp3",src:window.URL.createObjectURL(e),data:e,date:s,seconds:this.seconds}),n.TourInfo.files.push({type:"audio",name:"record-"+t+".mp3",src:window.URL.createObjectURL(e),data:e,date:s,seconds:this.seconds}),this.countSeconds(),this.saveFiles(n,1),this.getImagePreviews(n.new_files)},deleteFile:function(e,n,t){t.delete_files.push(e),t.TourInfo.files.splice(n,1),this.saveFiles(t,0)},getImagePreviews:function(e){for(var n=this,t=function(t){if(/\.(jpe?g|png|svg)$/i.test(e[t].name)){var s=new FileReader;s.addEventListener("load",function(){this.$refs["preview"+parseInt(t)][0].src=s.result}.bind(n),!1),s.readAsDataURL(e[t].data)}else n.$nextTick((function(){this.$refs["preview"+parseInt(t)][0].src="/images/LOGO-1.png"}))},s=0;s<e.length;s++)t(s)},onStream:function(e){this.countSeconds(),console.log("Got a stream object:",e)},countSeconds:function(){this.flag=!this.flag,1==this.flag?(this.seconds=0,this.interval=setInterval(this.incrementSeconds,1e3)):clearInterval(this.interval)},incrementSeconds:function(){this.seconds+=1}},directives:{mask:s.mask}};var c=t(85072),x=t.n(c),d=t(77994),u={insert:"head",singleton:!1};x()(d.A,u);d.A.locals;var p=t(1282),m={insert:"head",singleton:!1};x()(p.A,m);p.A.locals;var f=t(14486);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function h(){h=function(){return n};var e,n={},t=Object.prototype,s=t.hasOwnProperty,o=Object.defineProperty||function(e,n,t){e[n]=t.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",r=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{c({},"")}catch(e){c=function(e,n,t){return e[n]=t}}function x(e,n,t,s){var i=n&&n.prototype instanceof b?n:b,a=Object.create(i.prototype),r=new D(s||[]);return o(a,"_invoke",{value:C(e,t,r)}),a}function d(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=x;var u="suspendedStart",p="suspendedYield",m="executing",f="completed",v={};function b(){}function y(){}function w(){}var _={};c(_,a,(function(){return this}));var I=Object.getPrototypeOf,T=I&&I(I(O([])));T&&T!==t&&s.call(T,a)&&(_=T);var k=w.prototype=b.prototype=Object.create(_);function $(e){["next","throw","return"].forEach((function(n){c(e,n,(function(e){return this._invoke(n,e)}))}))}function L(e,n){function t(o,i,a,r){var l=d(e[o],e,i);if("throw"!==l.type){var c=l.arg,x=c.value;return x&&"object"==g(x)&&s.call(x,"__await")?n.resolve(x.__await).then((function(e){t("next",e,a,r)}),(function(e){t("throw",e,a,r)})):n.resolve(x).then((function(e){c.value=e,a(c)}),(function(e){return t("throw",e,a,r)}))}r(l.arg)}var i;o(this,"_invoke",{value:function(e,s){function o(){return new n((function(n,o){t(e,s,n,o)}))}return i=i?i.then(o,o):o()}})}function C(n,t,s){var o=u;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===f){if("throw"===i)throw a;return{value:e,done:!0}}for(s.method=i,s.arg=a;;){var r=s.delegate;if(r){var l=A(r,s);if(l){if(l===v)continue;return l}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(o===u)throw o=f,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);o=m;var c=d(n,t,s);if("normal"===c.type){if(o=s.done?f:p,c.arg===v)continue;return{value:c.arg,done:s.done}}"throw"===c.type&&(o=f,s.method="throw",s.arg=c.arg)}}}function A(n,t){var s=t.method,o=n.iterator[s];if(o===e)return t.delegate=null,"throw"===s&&n.iterator.return&&(t.method="return",t.arg=e,A(n,t),"throw"===t.method)||"return"!==s&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+s+"' method")),v;var i=d(o,n.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var a=i.arg;return a?a.done?(t[n.resultName]=a.value,t.next=n.nextLoc,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function N(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function z(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function O(n){if(n||""===n){var t=n[a];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,i=function t(){for(;++o<n.length;)if(s.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return i.next=i}}throw new TypeError(g(n)+" is not iterable")}return y.prototype=w,o(k,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:y,configurable:!0}),y.displayName=c(w,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===y||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},$(L.prototype),c(L.prototype,r,(function(){return this})),n.AsyncIterator=L,n.async=function(e,t,s,o,i){void 0===i&&(i=Promise);var a=new L(x(e,t,s,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},$(k),c(k,l,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var s in n)t.push(s);return t.reverse(),function e(){for(;t.length;){var s=t.pop();if(s in n)return e.value=s,e.done=!1,e}return e.done=!0,e}},n.values=O,D.prototype={constructor:D,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(z),!n)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function o(s,o){return r.type="throw",r.arg=n,t.next=s,o&&(t.method="next",t.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],r=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=s.call(a,"catchLoc"),c=s.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&s.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=n,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),v},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),z(t),v}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var s=t.completion;if("throw"===s.type){var o=s.arg;z(t)}return o}}throw Error("illegal catch attempt")},delegateYield:function(n,t,s){return this.delegate={iterator:O(n),resultName:t,nextLoc:s},"next"===this.method&&(this.arg=e),v}},n}function v(e,n,t,s,o,i,a){try{var r=e[i](a),l=r.value}catch(e){return void t(e)}r.done?n(l):Promise.resolve(l).then(s,o)}const b={components:{UserTable:(0,f.A)(l,(function(){var e=this,n=e._self._c;return n("div",{staticClass:"w-100 m-auto"},[n("b-row",[n("b-col",{staticClass:"my-1",attrs:{lg:"6"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"Сортировка","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"order_bySelect1"}},[n("b-input-group",{attrs:{size:"sm"}},[n("b-form-select",{staticClass:"w-75",attrs:{id:"order_bySelect1",options:e.sortOptions},scopedSlots:e._u([{key:"first",fn:function(){return[n("option",{attrs:{value:""}},[e._v("-- none --")])]},proxy:!0}]),model:{value:e.order_by,callback:function(n){e.order_by=n},expression:"order_by"}}),e._v(" "),n("b-form-select",{staticClass:"w-25",attrs:{size:"sm",disabled:!e.order_by},model:{value:e.sortDesc,callback:function(n){e.sortDesc=n},expression:"sortDesc"}},[n("option",{domProps:{value:!1}},[e._v("Asc")]),e._v(" "),n("option",{domProps:{value:!0}},[e._v("Desc")])])],1)],1)],1),e._v(" "),n("b-col",{staticClass:"my-1",attrs:{lg:"6"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"Поиск","label-cols-sm":"3","label-align-sm":"right","label-size":"sm","label-for":"filterInput"}},[n("b-input-group",{attrs:{size:"sm"}},[n("b-form-input",{attrs:{type:"search",id:"filterInput",placeholder:"Введите для поиска"},model:{value:e.filter,callback:function(n){e.filter=n},expression:"filter"}}),e._v(" "),n("b-input-group-append",[n("b-button",{attrs:{disabled:!e.filter},on:{click:function(n){e.filter=""}}},[e._v("Очистить")])],1)],1)],1)],1),e._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"5",md:"6"}},[n("b-form-group",{staticClass:"mb-0",attrs:{label:"На странице","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect1"}},[n("b-form-select",{attrs:{id:"perPageSelect1",size:"sm",options:e.pageOptions},model:{value:e.perPage,callback:function(n){e.perPage=n},expression:"perPage"}})],1)],1),e._v(" "),n("b-col",{staticClass:"my-1",attrs:{sm:"7",md:"6"}},[n("b-pagination",{staticClass:"my-0",attrs:{"total-rows":e.totalRows,"per-page":e.perPage,align:"fill",size:"sm"},model:{value:e.currentPage,callback:function(n){e.currentPage=n},expression:"currentPage"}})],1)],1),e._v(" "),n("b-table",{attrs:{"show-empty":"",small:"",stacked:"md",items:e.tours,fields:e.fields,"current-page":e.currentPage,"per-page":e.perPage,filter:e.filter,filterIncludedFields:e.filterOn,"sort-by":e.order_by,"sort-desc":e.sortDesc,"sort-direction":e.order_direction,busy:e.loading,"empty-text":"Нет записей для отображения","empty-filtered-text":"Нет записей, соответствующих вашему запросу"},on:{"update:sortBy":function(n){e.order_by=n},"update:sort-by":function(n){e.order_by=n},"update:sortDesc":function(n){e.sortDesc=n},"update:sort-desc":function(n){e.sortDesc=n},filtered:e.onFiltered},scopedSlots:e._u([{key:"cell(created_at)",fn:function(n){return[e._v("\n                "+e._s(e._f("moment")(n.item.created_at,"DD.MM.YYYY"))+"\n            ")]}},{key:"cell(action1)",fn:function(t){return[n("b-input-group",{attrs:{size:"sm"}},[n("b-button",{staticClass:"w-100 btn btn-travel mr-1 mb-1 btn-travel",on:{click:function(n){return e.toEditTour(t.item.id)}}},[e._v("\n                        Редактировать\n                    ")])],1)]}},{key:"cell(action2)",fn:function(t){return[n("b-input-group",{attrs:{size:"sm"}},[null==t.item.deleted_at?n("b-button",{staticClass:"btn btn-info mr-1 mb-1 btn-travel w-100",attrs:{disabled:null===t.item.id},on:{click:function(n){return e.destroy(t.item.id)}}},[e._v("\n                            Удалить\n                    ")]):e._e()],1)]}},{key:"table-busy",fn:function(){return[n("div",{staticClass:"text-center text-warning my-2"},[n("b-spinner",{staticClass:"align-middle",attrs:{variant:"warning"}}),e._v(" "),n("strong",[e._v("Загрузка...")])],1)]},proxy:!0}])})],1)}),[],!1,null,"45976b08",null).exports},data:function(){return{loading:!1,toursTotalRows:0,deletedToursTotalRows:0,current_client:{},clientTours:[]}},computed:{menu:function(){return this.$store.getters.menu},isAdmin:function(){return this.$store.getters.isAdmin},isManager:function(){return this.$store.getters.isManager},clients:function(){return this.$store.getters.clients},client:function(){return this.current_client},managers:function(){return this.$store.getters.managers},manager:function(){return this.current_manager},tourModule:function(){return this.$store.getters.tourModule},countries:function(){return this.$store.getters.countries},cities:function(){return this.$store.getters.cities},hotels:function(){return this.$store.getters.hotels},branches:function(){return this.$store.getters.branches},isCountriesLoading:function(){return this.$store.getters.isCountriesLoading},isCitiesLoading:function(){return this.$store.getters.isCitiesLoading},isHotelsLoading:function(){return this.$store.getters.isHotelsLoading}},created:function(){var e=this;0===this.countries.length&&this.$store.dispatch("getCountries",{town_id:0}),this.clients.length>0?(this.loading=!0,this.current_client=this.clients.find((function(n){return n.id==e.$route.params.id})),this.loading=!1):this.getClient()},mounted:function(){},methods:{toCreateTour:function(){this.isAdmin&&this.$router.push("/admin/client-tours/"+this.$route.params.id+"/create"),this.isManager&&this.$router.push("/manager/client-tours/"+this.$route.params.id+"/create")},getClient:function(){var e,n=this;return(e=h().mark((function e(){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.loading=!0,e.next=3,n.$store.dispatch("setClients").then((function(e){n.$store.commit("setClients",e.data.users),n.$store.commit("setDeletedClients",e.data.deleted_users),n.current_client=n.clients.find((function(e){return e.id==n.$route.params.id})),n.toursTotalRows=n.current_client.tours.length,n.loading=!1}));case 3:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(s,o){var i=e.apply(n,t);function a(e){v(i,s,o,a,r,"next",e)}function r(e){v(i,s,o,a,r,"throw",e)}a(void 0)}))})()},sendMessage:function(e){this.$notify({group:"info",type:"travel",title:"Туры пользователей",text:e})}}};var y=t(53361),w={insert:"head",singleton:!1};x()(y.A,w);y.A.locals;const _=(0,f.A)(b,(function(){var e=this,n=e._self._c;return n("b-container",{attrs:{fluid:""}},[n("div",{staticClass:"row w-100 my-3"},[n("b-button",{staticClass:"btn-travel",attrs:{variant:"primary"},on:{click:e.toCreateTour}},[e._v("Создать тур")])],1),e._v(" "),n("div",{staticClass:"row w-100 mt-3"},[n("user-table",{attrs:{tours:e.client.tours,loading:e.loading,totalRows:e.toursTotalRows}})],1)])}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=5170.js.map